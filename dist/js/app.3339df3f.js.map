{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils.js","webpack:///./src/host/hostScriptListener.js","webpack:///./src/eventBus.js","webpack:///./src/server/pipelineEngineState.js","webpack:///./src/global/envPaths.js","webpack:///./src/global/index.js","webpack:///external \"http\"","webpack:///./src/server/imageSource.js","webpack:///external \"crypto\"","webpack:///external \"child_process\"","webpack:///external \"assert\"","webpack:///./src/arrayMap.js","webpack:///./src/store/config.js","webpack:///./src/store/index.js","webpack:///./src/server/imageSourceType.js","webpack:///./src/folderTree.js","webpack:///./src/components/tabs.vue","webpack:///./src/app.vue?c350","webpack:///./src/themeManager.js","webpack:///src/components/tabs.vue","webpack:///./src/components/tabs.vue?7bcf","webpack:///./src/components/tab.vue?247c","webpack:///src/components/tab.vue","webpack:///./src/components/tab.vue?07ab","webpack:///./src/components/tab.vue","webpack:///./src/components/main-controls.vue?ced8","webpack:///src/components/main-controls.vue","webpack:///./src/components/main-controls.vue?ab1d","webpack:///./src/components/main-controls.vue","webpack:///src/app.vue","webpack:///./src/app.vue?b1d1","webpack:///./src/app.vue","webpack:///./src/dialog/a-dialog-root.vue?d0e5","webpack:///./src/dialog/events.js","webpack:///./src/dialog/a-dialog.vue?118f","webpack:///src/dialog/a-dialog.vue","webpack:///./src/dialog/a-dialog.vue?3e02","webpack:///./src/dialog/a-dialog.vue","webpack:///./src/dialog/confirm.vue?c2cc","webpack:///src/dialog/confirm.vue","webpack:///./src/dialog/confirm.vue?f650","webpack:///./src/dialog/confirm.vue","webpack:///src/dialog/a-dialog-root.vue","webpack:///./src/dialog/a-dialog-root.vue?ac8f","webpack:///./src/dialog/a-dialog-root.vue","webpack:///./src/dialog/index.js","webpack:///./src/validation/index.js","webpack:///./src/main.js","webpack:///./src/app.vue?9486","webpack:///./src/host/hostCallbackTunnelExec.js","webpack:///./src/host/hostCallbackTunnelSetTimeout.js","webpack:///./src/host/index.js","webpack:///./src/enum.js","webpack:///./src/components/wait-dots.vue?f4da","webpack:///src/components/wait-dots.vue","webpack:///./src/components/wait-dots.vue?2eb9","webpack:///./src/components/wait-dots.vue","webpack:///external \"util\"","webpack:///external \"os\"","webpack:///external \"stream\"","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///./src/server/image.js","webpack:///./src/server/imageFileMover.js","webpack:///./src/unc-safe-path/index.js","webpack:///./src/server/imageFileReader.js","webpack:///./src/server/imageFileProducer.js","webpack:///./src/server/imageFileProducers.js","webpack:///./src/server/pipelineEngineStatus.js","webpack:///./src/server/pipelineEngine.js","webpack:///./src/server/actions.js","webpack:///./src/server/index.js","webpack:///./src/circleBuffer.js","webpack:///./src/console/index.js","webpack:///external \"process\"","webpack:///./src/dialog/a-dialog-root.vue?ab78","webpack:///./src/components/tabs.vue?9d5e","webpack:///external \"querystring\"","webpack:///./src/fsx.js","webpack:///external \"events\""],"names":["i","chunkIds","length","deferredModules","j","deferredModule","chunkId","existingLinkTags","existingStyleTags","then","type","target","script","enumerable","get","getter","value","key","bind","module","Object","prototype","hasOwnProperty","call","object","property","console","error","err","jsonpArray","webpackJsonpCallback","EDebounceType","Trailing","Leading","Both","debounce","func","wait","immediate","timeout","context","this","args","arguments","later","apply","callNow","clearTimeout","setTimeout","throttle","callback","limit","trailingEdge","simpleDeepClone","obj","JSON","parse","stringify","guid","_p8","s","p","Math","random","toString","substr","yyyymmddhhmmss","date","pad2","n","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","defaultForNativeType","Symbol","first","Array","isArray","keys","unique","arr","Set","getOrDefine","defaultValue","undefined","isBoolean","val","isNumber","isObject","isEmptyObject","isString","isEmptyString","isUndefined","isNull","HostScriptListener","_scriptListenerActive","_scriptListenerReaderActive","_scriptListenerJsLogsPath","upath","join","os","homedir","_scriptListenerVbLogsPath","log","Promise","resolve","fs","writeFile","statSync","size","all","host","runJsx","values","includes","runActionWithParameters","result","Boolean","active","eventBus","Vue","PipelineEngineState","Enum","tmpdir","env","process","macos","name","library","path","config","temp","windows","appData","APPDATA","localAppData","LOCALAPPDATA","envPaths","options","TypeError","assign","suffix","platform","csInterface","CSInterface","getHostEnvironment","appVersion","appName","getCurrentApiVersion","major","minor","micro","getOSInformation","installPath","getSystemPath","SystemPath","EXTENSION","appInstallPath","normalize","appWorkingPath","appDefaultLogPath","appDefaultConfigPath","appBuiltinActionsPath","marioAppVersion","adobeApp","adobeVersion","adobeCEPApiVersion","exports","require","ImageSource","sourceType","sourceDirectory","sourceExtensions","useOutputDirectory","outputDirectory","useProcessedDirectory","processedDirectory","useErrorDirectory","errorDirectory","readMetadata","imageSource","getOwnPropertyNames","ArrayMap","map","Map","forEach","array","push","set","VALID_JSON_TYPES","Config","opts","_isLoaded","_isLoading","_isSaved","_isSaving","_isAnotherSavePending","_lastSavedTime","_doAutoSave","autoSave","_schema","schema","_data","_createDefaultConfigObject","_dataFilePath","filePath","doExtend","_extend","entries","_isValidJsonTypeName","default","_typeOf","_defaultForTypeName","Error","defineProperty","configurable","readFile","jsonString","code","data","_validateConfig","emit","now","nextTick","save","split","reduce","accumulator","tokens","lastToken","pop","parent","EventEmitter","GeneralConfig","appGlobal","checkIsScriptListenerActiveOnStart","pauseAfterEveryPipeline","pauseAfterEveryAction","pauseAfterEveryImage","pauseOnExceptions","logDirectory","logFilePersistForDays","logHtmlBufferMaxSize","runHttpServer","serverPort","pathToUserActions","fileSources","currentTab","isMainDrawerOpen","source","find","fromObject","PipelinesConfig","pipelines","pipelineNames","includeDisabled","filter","disabled","pipelineName","fileSourceNameToPipelineNames","pipeline","getByName","sourceNames","fileSourceName","Store","general","on","load","ImageSourceType","FolderTreeNode","isDirectory","children","hasChildren","node","c","names","reverse","namePath","nodeName","shift","isEndOfPath","childIsDirectory","child","getChildByName","addChild","removeChild","arrayify","newNode","oldNode","newRoot","clone","newStack","oldStack","oldChild","newChild","model","_vm","_h","$createElement","_c","_self","attrs","currentTabComponent","onTabChanged","_v","staticClass","tag","staticRenderFns","themeManager","updateThemeWithAppSkinInfo","appSkinInfo","sentinelColor","panelBackgroundColor","color","red","themeIsLight","document","body","classList","remove","add","getElementById","href","style","background","toHex","computeValue","rgb","hex","Number","green","blue","onAppThemeColorChanged","event","init","addEventListener","THEME_COLOR_CHANGED_EVENT","component","class","isActive","$event","preventDefault","stopPropagation","onClick","_t","ref","scopedSlots","_u","fn","handleSubmit","indexOf","_k","keyCode","onPipelineRun","directives","rawName","expression","onPipelineResume","onPipelinePause","isStopped","onPipelineStop","_s","pipelineEngineStateText","_e","pipelinefilePathText","pipelineText","pipelineActionText","isOpen","width","height","maxWidth","maxHeight","backdropClose","_g","_b","close","props","listeners","events","open","onClose","message","$emit","Plugin","install","$dialog","openConfirm","ADialogRoot","setInteractionMode","extend","validate","min","max","parseInt","_","params","required","valid","computesRequired","access","exists","allowed","toLowerCase","trim","isUnc","startsWith","isAbsolute","global","setWindowTitle","chdir","__dirname","productionTip","devtools","use","Dialog","destroy","Server","Host","Logger","create","Validation","window","vue","render","h","App","beforeDestroy","$mount","HostCallbackTunnelExec","cwd","childProcess","tunnelId","id","stream","callbackId","command","child_process","exec","stdout","stderr","jsx","replace","killed","kill","removeAllListeners","HostCallbackTunnelSetTimeout","timeoutId","delay","interface","_initialized","_nextTunnelId","_tunnelIdToTunnel","importScript","_onExec","_onSetTimeout","tunnel","eventName","scope","CSEvent","dispatchEvent","once","_openTunnel","store","setId","getId","_exitTunnel","delete","runJsxWithThrow","finally","fileName","importPath","evalScript","reject","lowerCaseResult","functionName","parameters","parametersJson","charId","stringId","enumArr","offset","create_","nextKey","validName","enumer","isInteger","test","lastIndex","toArray","slice","isValid","toKey","toUpperCase","domProps","dots","Image","initialInputImagePath","inputImagePath","inputDirectory","metadata","jobId","errors","ImageFileMover","images","image","_writeError","_moveImage","toDirectory","_moveToDirectory","directory","paths","_getImagePaths","basename","toPath","fsx","overwrite","warn","logPath","toLocaleString","flag","isUncPath","isAncestor","ancestor","descendant","relative","endsWith","dirname","_preserveUnc","firstPart","originalPath","newPath","charAt","ImageFileReader","targetPipelines","_isPathDefinedAndAbsolute","uncSafePath","_doesFileExist","_doesPathHaveJsonExtension","_readJson","_ensureAbsolutePath","_makeDirectory","_readMetadata","jsonFilePath","encoding","e","ep","exiftool","ExiftoolProcess","pid","fileMetadata","parentDirectory","extname","lstatSync","isFile","mkdir","recursive","nextProducerId","ImageFileProducer","_id","_imageSource","_fileWatcher","_isDepleted","_q","_emitQFiles","FILEWATCHER","_sourceFileWatchers","DIRECTORY","_sourceDirectory","OPENFILES","_sourceOpenFiles","BLANK","_sourceBlank","ACTIVEDOCUMENT","_sourceActiveDocument","files","_emitFiles","watchPathRoot","watchExtensions","watchPaths","ext","existsSync","watcher","chokidar","watch","ignored","depth","usePolling","interval","awaitWriteFinish","stabilityThreshold","pollInterval","extensions","readdir","file","filePaths","ImageFileProducers","_producerIdToListenerNames","_producerIdToProducer","_jobs","stopProducers","listenerNames","producer","_onProducerFiles","_onProducerDepleted","produce","producerIds","_stopProducers","has","producerId","getImageSource","jobCreationTime","PipelineEngineStatus","reset","seal","fileCount","imageJobId","imageIteration","action","PipelineEngine","self","_processingMutex","_lastState","STOPPED","_state","_status","Proxy","Reflect","actionName","_imageFileReader","_imageFileMover","_imageFileProducers","_onProducerJob","state","_run","IDLE","imageSourceNameToPipelineNames","getImageSourceNameToPipelineNameMap","imageSourceName","toPipelineNames","getImageSourceByName","startProducer","isProcessing","isIdle","PAUSED","isPaused","PROCESSING","hasProducers","stop","_process","_stopIfNoProducersElseIdle","hasJobs","_runWaitOneFrame","_runProcessStart","_runProcessLoop","_runProcessEnd","_pauseCheck","getTotalJobs","processedImages","_stopCheck","nextJob","read","_runPipelinesLoop","move","getByNames","_runPipelineStart","actions","_runPipelineEnd","actionResult","forcePause","jobs","getAllJobs","status","serialize","jsdoc","ROOT_ACTION_NAMESPACE","ActionDescriptor","description","jsdocDescription","d","descriptor","longname","ActionParameter","fromJSDoc","meta","typeNames","isRequired","jsdocParameter","optional","param","ActionFileDescriptionReader","explain","cache","a","absolutePath","descriptions","_isFunction","_actionNameToJsDoc","kind","memberof","isEnum","ActionFileImportStringBuilder","pathToActions","rootNamespace","_buildJsxImportString","absolutePathToActions","imports","directories","namespace","namespaceDefine","readdirSync","nameParts","nameWithoutExtension","nameSpacedName","absoluteFilePath","Action","importString","Actions","_actionNameToAction","_actionTree","_importAll","pathToBuildInActions","_import","importDirectory","build","actionPath","insert","readAll","cloneTree","from","port","app","ServerState","UNINITIALIZED","RUNNING","_httpServer","_pipelineEngine","_actions","startServer","polka","req","res","version","time","fullStatus","writeHead","end","listen","server","CircleBuffer","_array","_size","_pointer","CONSOLE_METHODS","initialized","originalConsoleMethods","logWriteStream","currentLogFileMonthDay","htmlLogBuffer","method","originalMethod","_write","_createLogsDirectory","_cleanupOldFiles","_createFileStream","chunk","toLocaleTimeString","htmlChunk","write","_closeFileStream","toISOString","createWriteStream","flags","autoClose","logFilenames","sort","logPaths","howManyToDelete","unlink","clear","acc","logger","fromPath","rimraf","rename","rmdir","cb","maxBusyTries","maxRetries","emfileWait","retryDelay","dirPath","_mkdirRecursive","mode"],"mappings":"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","file":"js/app.3339df3f.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded CSS chunks\n \tvar installedCssChunks = {\n \t\t\"app\": 0\n \t}\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({}[chunkId]||chunkId) + \".\" + {\"chunk-0c3fcab0\":\"2a73a57d\",\"chunk-5ee75350\":\"913717e8\",\"chunk-61cbdd70\":\"4b654bda\",\"chunk-970c75f4\":\"a9089de8\",\"chunk-3c7da850\":\"4adfb58c\",\"chunk-ff8c1068\":\"486d8906\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// mini-css-extract-plugin CSS loading\n \t\tvar cssChunks = {\"chunk-0c3fcab0\":1,\"chunk-5ee75350\":1,\"chunk-61cbdd70\":1,\"chunk-3c7da850\":1,\"chunk-ff8c1068\":1};\n \t\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n \t\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n \t\t\tpromises.push(installedCssChunks[chunkId] = new Promise(function(resolve, reject) {\n \t\t\t\tvar href = \"css/\" + ({}[chunkId]||chunkId) + \".\" + {\"chunk-0c3fcab0\":\"9570654b\",\"chunk-5ee75350\":\"40fcd3af\",\"chunk-61cbdd70\":\"8e1e1399\",\"chunk-970c75f4\":\"31d6cfe0\",\"chunk-3c7da850\":\"bc3553f5\",\"chunk-ff8c1068\":\"f2d4ab73\"}[chunkId] + \".css\";\n \t\t\t\tvar fullhref = __webpack_require__.p + href;\n \t\t\t\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n \t\t\t\tfor(var i = 0; i < existingLinkTags.length; i++) {\n \t\t\t\t\tvar tag = existingLinkTags[i];\n \t\t\t\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n \t\t\t\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return resolve();\n \t\t\t\t}\n \t\t\t\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n \t\t\t\tfor(var i = 0; i < existingStyleTags.length; i++) {\n \t\t\t\t\tvar tag = existingStyleTags[i];\n \t\t\t\t\tvar dataHref = tag.getAttribute(\"data-href\");\n \t\t\t\t\tif(dataHref === href || dataHref === fullhref) return resolve();\n \t\t\t\t}\n \t\t\t\tvar linkTag = document.createElement(\"link\");\n \t\t\t\tlinkTag.rel = \"stylesheet\";\n \t\t\t\tlinkTag.type = \"text/css\";\n \t\t\t\tlinkTag.onload = resolve;\n \t\t\t\tlinkTag.onerror = function(event) {\n \t\t\t\t\tvar request = event && event.target && event.target.src || fullhref;\n \t\t\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + request + \")\");\n \t\t\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n \t\t\t\t\terr.request = request;\n \t\t\t\t\tdelete installedCssChunks[chunkId]\n \t\t\t\t\tlinkTag.parentNode.removeChild(linkTag)\n \t\t\t\t\treject(err);\n \t\t\t\t};\n \t\t\t\tlinkTag.href = fullhref;\n\n \t\t\t\tvar head = document.getElementsByTagName(\"head\")[0];\n \t\t\t\thead.appendChild(linkTag);\n \t\t\t}).then(function() {\n \t\t\t\tinstalledCssChunks[chunkId] = 0;\n \t\t\t}));\n \t\t}\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\tvar error = new Error('Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')');\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export const EDebounceType = {\r\n    Trailing: 0,\r\n    Leading: 1,\r\n    Both: 2\r\n};\r\n\r\n/**\r\n *  Returns a function, that, as long as it continues to be invoked, will not\r\n * be triggered. The function will be called after it stops being called for\r\n * N milliseconds.\r\n * If `immediate` is EDebounceType.Trailing, trigger the function on the trailing edge, instead of the leading.\r\n * If `immediate` is EDebounceType.Both, trigger the function on both leading and trailing edges.\r\n */\r\nfunction debounce(func, wait, immediate) {\r\n    var timeout;\r\n    return function() {\r\n        var context = this, args = arguments;\r\n        var later = function() {\r\n            timeout = null;\r\n            if (immediate === EDebounceType.Trailing || immediate === EDebounceType.Both) \r\n                func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) { func.apply(context, args); }\r\n    }\r\n}\r\n\r\n/** \r\n * Returns a function which may only be called once every 'limit' milliseconds.\r\n*/\r\nfunction throttle (callback, limit, trailingEdge) {\r\n    var wait = false;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        if (!wait) {\r\n            callback.apply(context, args);\r\n            wait = true;\r\n            setTimeout(function () {\r\n                wait = false;\r\n                if(trailingEdge) \r\n                    callback.apply(context, args);         \r\n            }, limit);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Basic object deep cloning using JSON parse & stringify\r\n * @param {object|array} obj \r\n */\r\nfunction simpleDeepClone(obj)\r\n{\r\n    return JSON.parse(JSON.stringify(obj));\r\n}\r\n/**\r\n * Generates a GUID string. Not a standard-compliant GUID.\r\n * @returns {string} The generated GUID.\r\n * @example af8a8416-6e18-a307-bd9c-f2c947bbb3aa\r\n * @author Slavik Meltser.\r\n * @link http://slavik.meltser.info/?p=142\r\n */\r\nfunction guid() \r\n{\r\n    function _p8(s) {\r\n        var p = (Math.random().toString(16)+\"000000000\").substr(2,8);\r\n        return s ? \"-\" + p.substr(0,4) + \"-\" + p.substr(4,4) : p ;\r\n    }\r\n    return _p8() + _p8(true) + _p8(true) + _p8();\r\n}\r\n\r\n/**\r\n* Returns the date in format YYYYMMDDhhmmss\r\n*/\r\nfunction yyyymmddhhmmss(date) \r\n{\r\n    function pad2(n) {  // always returns a string\r\n        return (n < 10 ? '0' : '') + n;\r\n    }\r\n    date = date || new Date();\r\n    return date.getFullYear() +\r\n            pad2(date.getMonth() + 1) + \r\n            pad2(date.getDate()) +\r\n            pad2(date.getHours()) +\r\n            pad2(date.getMinutes()) +\r\n            pad2(date.getSeconds());\r\n}\r\n\r\nfunction defaultForNativeType(value) \r\n{\r\n    switch (typeof value) {\r\n        case 'boolean'   : return false;\r\n        case 'function'  : return function () {};\r\n        case 'null'      : return null;\r\n        case 'number'    : return 0;\r\n        case 'object'    : return {};\r\n        case 'string'    : return \"\";\r\n        case 'symbol'    : return Symbol();\r\n        case 'undefined' : return void 0;\r\n        default: return null;\r\n    }\r\n}\r\n\r\nfunction first(obj) \r\n{\r\n    if(Array.isArray(obj)) {\r\n        return obj[0];\r\n    } \r\n    return obj[Object.keys(obj)[0]];\r\n}\r\n/**\r\n * Returns new array containing only unique values\r\n * Works for Numbers, Strings, and Boolean\r\n * @param {Array} arr \r\n */\r\nfunction unique(arr) {\r\n    return [...new Set(arr)];\r\n}\r\nfunction getOrDefine(obj, key, defaultValue) \r\n{\r\n    if(obj[key] === undefined) {\r\n        obj[key] = defaultValue;\r\n    }\r\n    return obj[key];\r\n}\r\nfunction isBoolean(val) {\r\n    return typeof val === \"boolean\";\r\n}\r\nfunction isNumber(val) {\r\n    return typeof val === \"number\" && val === val;\r\n}\r\nfunction isObject(val) {\r\n    return val !== null && typeof(val) === \"object\";\r\n}\r\nfunction isEmptyObject(obj) \r\n{\r\n    return Object.keys(obj || {}).length === 0;\r\n}\r\nfunction isString(val) {\r\n    return typeof val === \"string\";\r\n}\r\nfunction isEmptyString(val) {\r\n    return val === \"\";\r\n}\r\nfunction isArray(val) \r\n{\r\n    return Array.isArray(val)\r\n}\r\nfunction isUndefined(val) {\r\n    return typeof val === \"undefined\";\r\n}\r\nfunction isNull(val) {\r\n    return val === null;\r\n}\r\n\r\n\r\nexport default {\r\n    throttle,\r\n    debounce,\r\n    simpleDeepClone,\r\n    guid, \r\n    yyyymmddhhmmss,\r\n    defaultForNativeType,\r\n    first,\r\n    unique,\r\n    getOrDefine,\r\n    isBoolean, \r\n    isNumber,\r\n    isObject,\r\n    isEmptyObject,\r\n    isString,\r\n    isEmptyString,\r\n    isArray,\r\n    isUndefined, \r\n    isNull\r\n}","import os from 'os';\r\nimport fs from 'fs';\r\nimport upath from 'upath';\r\nimport host from './index';\r\n\r\n/**\r\n * Creative Suite Extendscript Script Listener Interface\r\n */\r\nclass HostScriptListener\r\n{\r\n    constructor() {\r\n        this._scriptListenerActive = false;\r\n        this._scriptListenerReaderActive = false;\r\n\r\n        this._scriptListenerJsLogsPath = upath.join(os.homedir(), \"Desktop\", \"ScriptingListenerJS.log\");\r\n        this._scriptListenerVbLogsPath = upath.join(os.homedir(), \"Desktop\", \"ScriptingListenerVB.log\");\r\n    }\r\n    /**\r\n     * @returns {Promise}\r\n     */\r\n    init() \r\n    {\r\n        console.log(\"HostScriptListener initialized.\");\r\n        return Promise.resolve();\r\n    }\r\n    destroy()\r\n    {\r\n        // Cleanup\r\n    }\r\n    startScriptListenerReader()\r\n    {\r\n        // Determine if ScriptListener is on \r\n        // Folder.desktop\r\n        // const listenerLogsPath =  upath.join(os.homedir(), \"Desktop\", \"ScriptingListenerJS.log\");\r\n        // const scriptWatcher = chokidar.watch(listenerLogsPath, {\r\n        //     awaitWriteFinish: {\r\n        //         pollInterval: 100,\r\n        //         stabilityThreshold: 2000\r\n        //     }\r\n        // });\r\n        // scriptWatcher.on(\"change\", debounce(this.readScriptListenerLog, 1000));\r\n        // //...\r\n        // scriptWatcher.removeAllListeners();\r\n        // scriptWatcher.close();\r\n        // //...\r\n\r\n        this._scriptListenerReaderActive = true;\r\n    }\r\n    stopScriptListenerReader() \r\n    {\r\n\r\n    }\r\n    clearScriptListenerLogs() \r\n    {\r\n        fs.writeFile(this._scriptListenerJsLogsPath, \"\", err => {\r\n            if(err) throw err; \r\n        });\r\n        fs.writeFile(this._scriptListenerVbLogsPath, \"\", err => {\r\n            if(err) throw err;\r\n        });\r\n    }\r\n    onScriptListenerLogs() \r\n    {\r\n        // IMPORTANT: Somme commands generated by ScriptListenerPlugin will not run via evalScript.\r\n        // In particular, modal commands, such as \"modalStateChanged\" will throw an error\r\n        // fs.readFile(path, (err, data) => {\r\n        //     if(err) throw err; \r\n\r\n        //     fire event? or call registered callback?\r\n        // });\r\n    }\r\n    isScriptListenerActive() \r\n    {\r\n        let initialSize = 0;\r\n        try {\r\n            initialSize = fs.statSync(this._scriptListenerJsLogsPath).size;\r\n        } catch {}\r\n        \r\n        // How this works:\r\n        // Since Extendscript runs on a single thread, and ScriptListener runs on this same thread.\r\n        // The 1st call triggers ScriptListener to record actions.\r\n        // The 2nd call is to ensure ScriptListener is done recording, before we read log file stats.\r\n        return Promise.all([\r\n            host.runJsx(`\r\n                app.bringToFront();\r\n                var document = app.documents.add(\"1px\", \"1px\", 1, \"ScriptListenerCheck\");\r\n                document.close(SaveOptions.SAVECHANGES);\r\n            `),\r\n            host.runJsx(`noop();`)\r\n        ])\r\n        .then(values => {\r\n            if(values[0].includes(\"error\")) {\r\n                console.error(\"Could not determine if ScriptListener is active.\");\r\n                return false;\r\n            }\r\n            try {\r\n                fs.statSync(this._scriptListenerJsLogsPath).size > initialSize;\r\n            } catch {\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    isScriptListenerIstalled()\r\n    {\r\n        return host.runActionWithParameters(\"action.getIsScriptListenerInstalled\")\r\n        .then(result => Boolean(result));\r\n    }\r\n    toggleScriptListener(active)\r\n    {\r\n        return host.runActionWithParameters(\"action.setScriptListenerActive\", active);\r\n    }\r\n}\r\n\r\nexport default new HostScriptListener();","import Vue from 'vue';\r\nconst eventBus = new Vue();\r\nexport default eventBus;\r\n","import Enum from '../enum';\r\n\r\nconst PipelineEngineState = new Enum([\r\n    \"STOPPED\",\r\n    \"IDLE\", \r\n    \"PAUSED\",\r\n    \"PROCESSING\",\r\n]);\r\n\r\nexport default PipelineEngineState;","'use strict';\r\n/*\r\n    See npm \"env-paths\"\r\n*/\r\nimport path from 'path';\r\nimport os from 'os';\r\n\r\nconst homedir = os.homedir();\r\nconst tmpdir = os.tmpdir();\r\nconst { env } = process;\r\n\r\nconst macos = name => {\r\n\tconst library = path.join(homedir, 'Library');\r\n\r\n\treturn {\r\n\t\tconfig: path.join(library, 'Preferences', name),\r\n\t\tlog: path.join(library, 'Logs', name),\r\n\t\ttemp: path.join(tmpdir, name)\r\n\t};\r\n};\r\n\r\nconst windows = name => {\r\n\tconst appData = env.APPDATA || path.join(homedir, 'AppData', 'Roaming');\r\n\tconst localAppData = env.LOCALAPPDATA || path.join(homedir, 'AppData', 'Local');\r\n\r\n\treturn {\r\n\t\tconfig: path.join(appData, name, 'Config'),\r\n\t\tlog: path.join(localAppData, name, 'Log'),\r\n\t\ttemp: path.join(tmpdir, name)\r\n\t};\r\n};\r\n\r\nconst envPaths = (name, options) => {\r\n\tif (typeof name !== 'string') {\r\n\t\tthrow new TypeError(`Expected string, got ${typeof name}`);\r\n\t}\r\n\r\n\toptions = Object.assign({suffix: 'nodejs'}, options);\r\n\r\n\tif (options.suffix) {\r\n\t\t// Add suffix to prevent possible conflict with native apps\r\n\t\tname += `-${options.suffix}`;\r\n\t}\r\n\r\n\tif (process.platform === 'darwin') {\r\n\t\treturn macos(name);\r\n\t}\r\n\tif (process.platform === 'win32') {\r\n\t\treturn windows(name);\r\n\t}\r\n\r\n\treturn null;\r\n};\r\n\r\nexport default envPaths;\r\n","import upath from 'upath';\r\nimport envPaths from './envPaths';\r\nimport { version as marioAppVersion } from '../../package.json';\r\n\r\n\r\nexport default (function() \r\n{\r\n    // Also see \"process.versions\"\r\n    const csInterface = new CSInterface();\r\n    const { appVersion, appName } = csInterface.getHostEnvironment();\r\n    const { major, minor, micro } = csInterface.getCurrentApiVersion();\r\n    const os = csInterface.getOSInformation()\r\n    const env = envPaths(\"Mario\");\r\n\r\n    const installPath = csInterface.getSystemPath(SystemPath.EXTENSION);\r\n    const appInstallPath = upath.normalize(installPath);\r\n    const appWorkingPath = upath.join(appInstallPath, process.env.VUE_APP_HOST_DIR);\r\n    const appDefaultLogPath = upath.normalize(env.log);\r\n    const appDefaultConfigPath = upath.normalize(env.config);\r\n    const appBuiltinActionsPath = upath.join(appWorkingPath, \"actions\");\r\n\r\n    return {\r\n        csInterface,\r\n        os,\r\n        appVersion: marioAppVersion,\r\n        appInstallPath, \r\n        appWorkingPath,\r\n        appDefaultLogPath,\r\n        appDefaultConfigPath,\r\n        appBuiltinActionsPath,\r\n        adobeApp: appName,\r\n        adobeVersion: appVersion, \r\n        adobeCEPApiVersion: `${major}.${minor}.${micro}`\r\n    }\r\n}());\r\n","module.exports = require(\"http\");","\r\nexport default class ImageSource\r\n{\r\n    /**\r\n     * Configuration for sourcing new images for processing\r\n     * @param {ImageSourceType} sourceType e.g. ImageSourceType.FILEWATCHER\r\n     * @param {string} name a user friendly name for the image source \r\n     * @param {string} [sourceDirectory] \r\n     * @param {Array<string>} [sourceExtensions] file extensions allowed by this file source (without '.')\r\n     * @param {boolean} [useOutputDirectory = false]\r\n     * @param {string} [outputDirectory] directory where pipeline outputs will be written\r\n     * @param {boolean} [useProcessedDirectory = false]\r\n     * @param {string} [processedDirectory] directory where source files will be moved to when finished processing\r\n     * @param {boolean} [useErrorDirectory = false]\r\n     * @param {string} [errorDirectory] directory where source files will be moved when an error is encountered\r\n     * @param {boolean} [readMetadata = false]\r\n     */\r\n    constructor(\r\n        sourceType, \r\n        name,\r\n        sourceDirectory, \r\n        sourceExtensions, \r\n        useOutputDirectory = false, \r\n        outputDirectory = \"\", \r\n        useProcessedDirectory = false,\r\n        processedDirectory = \"\", \r\n        useErrorDirectory = false,\r\n        errorDirectory = \"\",\r\n        readMetadata = false)\r\n    {\r\n        this.name = name;\r\n        this.sourceType = sourceType;\r\n        this.sourceDirectory = sourceDirectory;\r\n        this.sourceExtensions = sourceExtensions;\r\n\r\n        this.useOutputDirectory = useOutputDirectory;\r\n        this.outputDirectory = outputDirectory;\r\n        this.useProcessedDirectory = useProcessedDirectory;\r\n        this.processedDirectory = processedDirectory;\r\n        this.useErrorDirectory = useErrorDirectory;\r\n        this.errorDirectory = errorDirectory;\r\n        this.readMetadata = readMetadata;\r\n    }\r\n\r\n    clone() \r\n    {\r\n        // Shallow copy\r\n        let imageSource = new ImageSource();\r\n        return Object.assign(imageSource, this);\r\n    }\r\n    toString() \r\n    {\r\n        return `name = \"${this.name}\" type = ${this.sourceType} directory = \"${this.sourceDirectory}\"`;\r\n    }\r\n\r\n    static fromObject(object)\r\n    {\r\n        let imageSource = new ImageSource();\r\n        for(const key of Object.getOwnPropertyNames(object)) {\r\n            if(imageSource.hasOwnProperty(key)) {\r\n                imageSource[key] = object[key];\r\n            }\r\n        }\r\n        return imageSource;\r\n    }\r\n}\r\n","module.exports = require(\"crypto\");","module.exports = require(\"child_process\");","module.exports = require(\"assert\");","\r\nexport default class ArrayMap \r\n{\r\n    constructor() {\r\n        this.map = new Map();\r\n        [\"get\", \"has\", \"delete\", \"keys\", \"values\"].forEach(key => {\r\n            this[key] = this.map[key].bind(this.map);\r\n        });\r\n    }\r\n    set(key, value) {\r\n        let array = this.map.get(key);\r\n        if(Array.isArray(array)) {\r\n            array.push(value);\r\n        } else {\r\n            this.map.set(key, [value]);\r\n        }\r\n    }\r\n}","import fs from 'fs';\r\nimport EventEmitter from \"events\";\r\n\r\nexport const VALID_JSON_TYPES = [\r\n    'string',\r\n    'number',\r\n    'object',\r\n    'array',\r\n    'boolean'\r\n];\r\n\r\n/**\r\n * Configuration class for saving/loading data via JSON file.\r\n * Note that load() should be called after construction to read from file.\r\n * If save() is called before load(), any previous configuration will be overwritten.\r\n */\r\nexport default class Config extends EventEmitter\r\n{\r\n    /**\r\n     * Create a Config instance\r\n     * @param {Object} opts \r\n     * @param {boolean} [opts.autoSave = false] if true, automatically save to file when data changes\r\n     * @param {boolean} [opts.doExtend = false] if true, this instance is extended with setters/getters for property names specified in the schema\r\n     * @param {string} opts.filePath the absolute path to the configuration file, including its extension \r\n     * @param {Object} opts.schema\r\n     */\r\n    constructor(opts) \r\n    {\r\n        super();\r\n\r\n        this._isLoaded = false;\r\n        this._isLoading = false;\r\n        this._isSaved = false;\r\n        this._isSaving = false;\r\n        this._isAnotherSavePending = false;\r\n        this._lastSavedTime = 0;\r\n\r\n        this._doAutoSave = opts.autoSave === true;\r\n        this._schema = opts.schema;\r\n        this._data = this._createDefaultConfigObject();\r\n        this._dataFilePath = opts.filePath;\r\n        \r\n        if(opts.doExtend) {\r\n            this._extend();\r\n        }\r\n    }\r\n    _createDefaultConfigObject() \r\n    {\r\n        let config = {};\r\n        for (const [key, value] of Object.entries(this._schema)) \r\n        {\r\n            if (!this._isValidJsonTypeName(value.type)) {\r\n                throw new TypeError(`'type' ${value.type} for ${key} is not a valid JSON type name`);\r\n            } \r\n            if(value.default && this._typeOf(value.default) !== value.type) {\r\n                throw new TypeError(`'default' type ${this._typeOf(value.default)} does not match specified 'type'`);\r\n            }\r\n            config[key] = value.default || this._defaultForTypeName(value.type);\r\n        }\r\n        return config;\r\n    }\r\n    _validateConfig() \r\n    {\r\n        for (const [key, value] of Object.entries(this._data)) \r\n        {\r\n            if(!this._schema[key]) {\r\n                throw new Error(`Property ${key} not found in schema`);\r\n            }\r\n            if(this._typeOf(value) !== this._schema[key].type) {\r\n                throw new TypeError(`${this._typeOf(value)} does not match schema type ${this._schema[key].type}`)\r\n            }\r\n        }\r\n    }\r\n    _isValidJsonTypeName(type) {\r\n        return VALID_JSON_TYPES.includes(type);\r\n    }\r\n    _defaultForTypeName(type) {\r\n        switch(type) {\r\n            case 'string': return \"\";\r\n            case 'number': return 0;\r\n            case 'object': return {};\r\n            case 'array': return [];\r\n            case 'boolean': return false;\r\n        }\r\n        throw new Error(`default not defined for type ${type}`);\r\n    }\r\n    _typeOf(value) {\r\n        if(Array.isArray(value)) {\r\n            return \"array\";\r\n        } \r\n        return typeof value;\r\n    }\r\n    _extend() \r\n    {\r\n        for (const [key, value] of Object.entries(this._schema)) \r\n        {\r\n            Object.defineProperty(this, key, {\r\n                get() { \r\n                    return this.get(key);\r\n                },\r\n                set(value) { \r\n                    return this.set(key, value);\r\n                },\r\n                enumerable: true, \r\n                configurable: false\r\n            });\r\n        }\r\n    }\r\n\r\n    load() \r\n    {\r\n        if(this._isLoaded || this._isLoading) \r\n            return Promise.resolve();\r\n\r\n        return new Promise(resolve => \r\n        {\r\n            this._isLoading = true;\r\n            fs.readFile(this._dataFilePath, (err, jsonString) => {\r\n                this._isLoading = false;\r\n                // ENOENT = file missing\r\n                if(err && err.code !== 'ENOENT') throw err;\r\n                if(!err) {\r\n                    // Assume file exists and data read successfully\r\n                    const data = JSON.parse(jsonString);\r\n                    this._data = Object.assign(this._data, data);\r\n                    this._validateConfig();\r\n                }\r\n                this._isSaved = true;\r\n                this._isLoaded = true;\r\n                this.emit(\"loaded\");\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n    save() \r\n    {\r\n        if(this._isSaved) \r\n            return Promise.resolve();\r\n        if(this._isSaving) {\r\n            this._isAnotherSavePending = true;\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return new Promise(resolve => \r\n        {\r\n            this._isSaving = true;\r\n            fs.writeFile(this._dataFilePath, JSON.stringify(this._data, null, 2), err => {\r\n                this._isSaving = false;\r\n                if(err) throw err;\r\n\r\n                this._isLoaded = true;\r\n                this._isSaved = true;\r\n                this._lastSavedTime = Date.now();\r\n                this.emit(\"saved\", this._lastSavedTime);\r\n\r\n                if(this._isAnotherSavePending) {\r\n                    this._isAnotherSavePending = false;\r\n                    process.nextTick(() => this.save);\r\n                }\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n    getLastSavedTime() {\r\n        return this._lastSavedTime;\r\n    }\r\n    /**\r\n     * Same as getAll() except returns a deep copy\r\n     */\r\n    clone() \r\n    {\r\n        return JSON.parse(JSON.stringify(this._data));\r\n    }\r\n    /**\r\n     * Returns entire configuration object by reference\r\n     */\r\n    getAll() \r\n    {\r\n        return this._data;\r\n    }\r\n    get(key) \r\n    {\r\n\t\treturn key.split('.').reduce((accumulator, property) => accumulator[property], this._data);\r\n    }\r\n    set(key, value) \r\n    {\r\n        this._isSaved = false;\r\n\r\n        const tokens = key.split('.');\r\n        const lastToken = tokens.pop();\r\n        const parent = tokens.reduce((accumulator, property) => accumulator[property], this._data);\r\n        const property = parent[lastToken];\r\n        if(typeof property === \"undefined\") {\r\n            throw new Error(`Property ${key} not found.`);\r\n        }\r\n        if(this._typeOf(property) !== this._typeOf(value)) {\r\n            throw new TypeError(`Property ${key} type ${this._typeOf(property)} does not match value ${value} with type ${this._typeOf(value)}`);\r\n        }\r\n        // Set value\r\n        parent[lastToken] = value;\r\n        console.log(`Configuration updated. ${key} -> ${value}`);\r\n\r\n        if(this._doAutoSave) {\r\n            this.save();\r\n        }\r\n    }\r\n}","import upath from 'upath';\r\n\r\nimport ImageSource from '../server/imageSource';\r\nimport ArrayMap from '../arrayMap';\r\nimport Config from '../store/config';\r\nimport appGlobal from '../global';\r\nimport _ from '../utils';\r\n\r\n// TODO: Split General & Pipelines into their own Classes (and files)\r\n\r\n/**\r\n * General app configuration data \r\n */\r\nclass GeneralConfig extends Config\r\n{\r\n    constructor() {\r\n        super({\r\n            filePath: upath.join(appGlobal.appDefaultConfigPath, \"general.json\"),\r\n            doExtend: true,\r\n            schema: {\r\n                checkIsScriptListenerActiveOnStart: {\r\n                    type: \"boolean\", \r\n                    default: true\r\n                },\r\n                pauseAfterEveryPipeline: {\r\n                    type: \"boolean\",\r\n                    default: false\r\n                },\r\n                pauseAfterEveryAction: {\r\n                    type: \"boolean\",\r\n                    default: false\r\n                },\r\n                pauseAfterEveryImage: {\r\n                    type: \"boolean\",\r\n                    default: false\r\n                },\r\n                pauseOnExceptions: {\r\n                    type: \"boolean\",\r\n                    default: false\r\n                },\r\n                logDirectory: { \r\n                    type: \"string\",\r\n                    default: \"\"\r\n                },\r\n                logFilePersistForDays: {\r\n                    type: \"number\", \r\n                    default: 3\r\n                },\r\n                logHtmlBufferMaxSize: {\r\n                    type: \"number\",\r\n                    default: 256\r\n                },\r\n                runHttpServer: {\r\n                    type: \"boolean\",\r\n                    default: false\r\n                },\r\n                serverPort: {\r\n                    type: \"number\",\r\n                    default: 3001\r\n                },\r\n                pathToUserActions: {\r\n                    type: \"string\",\r\n                    default: \"\"\r\n                }, \r\n                fileSources: {\r\n                    type: \"array\",\r\n                    default: [\r\n                        // Objects matching ImageSource\r\n                    ]\r\n                },\r\n                currentTab: {\r\n                    type: \"string\",\r\n                    default: \"the-jsx-runner\"\r\n                },\r\n                isMainDrawerOpen: {\r\n                    type: \"boolean\", \r\n                    default: false\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Returns the ImageSource by the given name\r\n     * @param {string} name \r\n     * @returns {ImageSource}\r\n     */\r\n    getImageSourceByName(name) \r\n    {\r\n        const source = this._data.fileSources.find(s => s.name === name);\r\n        if(source) {\r\n            return ImageSource.fromObject(source);\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * Pipeline configurations \r\n */\r\nclass PipelinesConfig extends Config\r\n{\r\n    constructor() \r\n    {\r\n        super({\r\n            filePath: upath.join(appGlobal.appDefaultConfigPath, \"pipelines.json\"),\r\n            doExtend: true,\r\n            schema: {\r\n                pipelines: {\r\n                    type: \"array\",\r\n                    default: []\r\n                }\r\n            }\r\n        });\r\n    }\r\n    getByNames(pipelineNames, includeDisabled)\r\n    {\r\n        return this._data.pipelines.filter(p => {\r\n            return pipelineNames.includes(p.name) && (includeDisabled || !p.disabled);\r\n        });\r\n    }\r\n    getByName(pipelineName, includeDisabled) \r\n    {\r\n        return this._data.pipelines.find(p => {\r\n            return p.name === pipelineName && (includeDisabled || !p.disabled); \r\n        });\r\n    }\r\n    /**\r\n     * Returns unique mapping of image source name -> pipeline name\r\n     * @param {Array<string>} pipelineNames\r\n     * @param {boolean} [includeDisabled = false]\r\n     * @returns {ArrayMap<string, string>}\r\n     */\r\n    getImageSourceNameToPipelineNameMap(pipelineNames, includeDisabled) \r\n    {\r\n        // Collect all unique file sources for given pipelines\r\n        let fileSourceNameToPipelineNames = new ArrayMap();\r\n        pipelineNames.forEach(pipelineName =>\r\n        {\r\n            const pipeline = this.getByName(pipelineName);\r\n            if(!pipeline) {\r\n                return;\r\n            }\r\n            for(let fileSourceName of pipeline.sourceNames) {\r\n                fileSourceNameToPipelineNames.set(fileSourceName, pipeline.name);\r\n            }\r\n        });\r\n        return fileSourceNameToPipelineNames;\r\n    }\r\n}\r\n\r\nclass Store \r\n{\r\n    constructor() \r\n    {\r\n        /**\r\n         * General configuration storage\r\n         * NOTE: Properties are set by Reference.\r\n         */\r\n        this.general = new GeneralConfig();\r\n        this.general.on(\"loaded\", () => {\r\n            console.log(\"Configuration 'general' loaded.\");\r\n        });\r\n        this.general.on(\"saved\", () => {\r\n            console.log(\"Configuration 'general' saved.\");\r\n        });\r\n        /**\r\n         * Pipeline configuration storage\r\n         * NOTE: Properties are set by Reference.\r\n         */\r\n        this.pipelines = new PipelinesConfig();\r\n        this.pipelines.on(\"loaded\", () => {\r\n            console.log(\"Configuration 'pipelines' loaded.\");\r\n        });\r\n        this.pipelines.on(\"saved\", () => {\r\n            console.log(\"Configuration 'pipelines' saved.\");\r\n        });\r\n    }\r\n    async init() \r\n    {\r\n        console.log(\"Configurations loading started.\");\r\n\r\n        await this.general.load();\r\n        await this.pipelines.load();\r\n\r\n        console.log(\"Configurations loaded.\");\r\n    }\r\n}\r\n\r\n\r\nexport default new Store();","import Enum from '../enum';\r\n\r\nconst ImageSourceType = new Enum([\r\n    \"OPENFILES\", \r\n    \"DIRECTORY\", \r\n    \"FILEWATCHER\",\r\n    \"BLANK\",\r\n    \"ACTIVEDOCUMENT\",\r\n    \"REST\"\r\n]);\r\n\r\nexport default ImageSourceType","export default class FolderTreeNode\r\n{\r\n    constructor(name = \"\", isDirectory = false) {\r\n        // FolderTree\r\n        this.parent = null;\r\n        // boolean\r\n        this.isDirectory = isDirectory;\r\n        // string\r\n        this.name = name || \"\";\r\n        // Array<FolderTree>\r\n        this.children = [];\r\n    }\r\n    isRoot() { \r\n        return this.parent === null;\r\n    }\r\n    isLeaf() {\r\n        return !this.hasChildren();\r\n    }\r\n    hasChildren() {\r\n        return this.children.length > 0;\r\n    }\r\n    addChild(node)\r\n    {\r\n        node.parent = this;\r\n        this.children.push(node);\r\n    }\r\n    removeChild(node)\r\n    {\r\n        this.children = this.children.filter(c => c !== node);\r\n    }\r\n    getChildByName(name) {\r\n        return this.children.find(c => c.name === name);\r\n    }\r\n    /**\r\n     * @returns {string[]} an array of node names indicating the path to this node from the root\r\n     */\r\n    getNamePath() {\r\n        let node = this;\r\n        let names = [node.name];\r\n        while(node && (node = node.parent)) {\r\n            names.push(node.name);\r\n        }\r\n        return names.reverse();\r\n    }\r\n    insert(namePath, isDirectory)\r\n    {\r\n        let node = this;\r\n        let nodeName = (this.name === namePath[0]) ? namePath.shift() : \"\";\r\n        while(nodeName = namePath.shift())\r\n        {\r\n            const isEndOfPath = namePath.length === 0;\r\n            const childIsDirectory = isEndOfPath && !isDirectory ? false : true;\r\n            let child = node.getChildByName(nodeName);\r\n            if(!child) {\r\n                child = new FolderTreeNode(nodeName, childIsDirectory);\r\n                node.addChild(child);\r\n            } \r\n            node = child;\r\n        }\r\n    }\r\n    /**\r\n     * Returns the node given at the end of the name path by traversing the tree\r\n     * @param {string[]} namePath \r\n     * @returns {FolderTreeNode} or null\r\n     */\r\n    traverse(namePath)\r\n    {\r\n        let node = this;\r\n        let nodeName = (this.name === namePath[0]) ? namePath.shift() : \"\";\r\n        while(node && (nodeName = namePath.shift())) {\r\n            node = node.getChildByName(nodeName);\r\n        }\r\n        return node;\r\n    }\r\n    drop()\r\n    {\r\n        this.parent.removeChild(this);\r\n        this.parent = null;\r\n    }\r\n    arrayify(node)\r\n    {\r\n        // pre order traversal\r\n        if(node.hasChildren()) {\r\n            const result = node.children.map(c => node.arrayify(c));\r\n            return [node.name, result];\r\n        } else {\r\n            return node.name;\r\n        }\r\n    }\r\n    /**\r\n     * Clones this Folder tree node\r\n     */\r\n    clone()\r\n    {\r\n        return new FolderTreeNode(this.name, this.isDirectory);\r\n    }\r\n    /**\r\n     * Clones the Folder tree using this node as the root node\r\n     */\r\n    cloneTree()\r\n    {\r\n        let newRoot = this.clone();\r\n        let newStack = [newRoot];\r\n        let oldStack = [this];\r\n        let newNode, oldNode;\r\n        while((oldNode = oldStack.pop()) && (newNode = newStack.pop()))\r\n        {\r\n            for(let i = 0; i < oldNode.children.length; ++i)\r\n            {\r\n                let oldChild = oldNode.children[i];\r\n                let newChild = oldChild.clone();\r\n                newNode.addChild(newChild);\r\n                newStack.push(newChild);\r\n                oldStack.push(oldChild);\r\n            }\r\n        }\r\n        return newRoot;\r\n    }\r\n    parse(model)\r\n    {\r\n\r\n    }\r\n}\r\n","var render, staticRenderFns\nimport script from \"./tabs.vue?vue&type=script&lang=js&\"\nexport * from \"./tabs.vue?vue&type=script&lang=js&\"\nimport style0 from \"./tabs.vue?vue&type=style&index=0&id=55ac743d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"55ac743d\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('a-dialog-root'),_c('adobe-menus'),_c('tabs',{attrs:{\"initial-tab\":_vm.currentTabComponent},on:{\"changed\":_vm.onTabChanged}},[_c('tab',{attrs:{\"title\":\"the-console\"}},[_vm._v(\"Console\")]),_c('tab',{attrs:{\"title\":\"the-jsx-runner\"}},[_vm._v(\"Jsx\")]),_c('tab',{attrs:{\"title\":\"the-configurator\"}},[_vm._v(\"Configuration\")]),_c('tab',{attrs:{\"title\":\"the-pipelines\"}},[_vm._v(\"Pipelines\")])],1),_c('main-controls'),_c('section',{staticClass:\"tab-content\"},[_c('keep-alive',[_c(_vm.currentTabComponent,{tag:\"component\"})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const themeManager = (function () \n{\n    'use strict';\n    const csInterface = new CSInterface();\n\n    /**\n     * Update theme with AppSkinInfo from Host Product\n     */\n    function updateThemeWithAppSkinInfo(appSkinInfo) \n    {\n        let sentinelColor = appSkinInfo.panelBackgroundColor.color.red;\n        let themeIsLight = sentinelColor > 128;\n        \n        if (themeIsLight) {\n            document.body.classList.remove(\"dark\");\n            document.body.classList.add(\"light\");\n            document.getElementById(\"theme\").href = \"css/topcoat-desktop-light.css\";\n        } else {\n            document.body.classList.remove(\"light\");\n            document.body.classList.add(\"dark\");\n            document.getElementById(\"theme\").href = \"css/topcoat-desktop-dark.css\";\n        }\n        \n        document.body.style.background = \"#\" + toHex(appSkinInfo.panelBackgroundColor.color);\n    }\n\n    function toHex(color) \n    {\n        function computeValue(rgb) { \n            let hex = Number(rgb).toString(16);\n            if (hex.length < 2) { hex = \"0\" + hex }\n            return hex;\n        };\n        let hex = \"\";\n        if (color) {\n            hex = computeValue(color.red) + \n                    computeValue(color.green) + \n                    computeValue(color.blue);\n        }\n        return hex;\n    }\n  \n    function onAppThemeColorChanged(event) \n    {\n        let appSkinInfo = csInterface.getHostEnvironment().appSkinInfo;\n        updateThemeWithAppSkinInfo(appSkinInfo);\n    }\n  \n    function init() \n    {\n        let appSkinInfo = csInterface.getHostEnvironment().appSkinInfo;\n        updateThemeWithAppSkinInfo(appSkinInfo);\n        csInterface.addEventListener(CSInterface.THEME_COLOR_CHANGED_EVENT, onAppThemeColorChanged);\n    }\n  \n    return {\n        init: init\n    };\n  \n  }());\n\n  export default themeManager;","\r\n\r\n<script>\r\nexport default {\r\n    name: \"Tabs\",\r\n    props: {\r\n        initialTab: {\r\n            type: String,\r\n            required: true\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            activeTab: this.initialTab\r\n        }\r\n    },\r\n    computed: {\r\n        tabsList() {\r\n            return this.$slots.default;\r\n        }\r\n    },\r\n    mounted() {\r\n        this.$on('tab-click', this.onTabClick);\r\n    },\r\n    methods: {\r\n        onTabClick(tab) {\r\n            this.activeTab = tab;\r\n            this.$emit(\"changed\", this.activeTab);\r\n        },\r\n        isActiveTab(tab) {\r\n            return this.activeTab === tab;\r\n        }\r\n    },\r\n    render: function(createElement) {\r\n        // return a vnode (virtual dom node)\r\n        return createElement(\r\n            \"ul\",\r\n            {\r\n                class: \"tabs\"\r\n            },\r\n            // array of children\r\n            this.$slots.default.map(child => {\r\n                return createElement(\r\n                    \"li\", \r\n                    {\r\n                        class: \"tab\"\r\n                    },\r\n                    [child]\r\n                )\r\n            })\r\n        );\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    .tabs {\r\n        display: flex;\r\n        flex-shrink: 0;\r\n        justify-items: center;\r\n        list-style: none;\r\n        margin: .5em auto;\r\n        margin-right: auto;\r\n        padding: 0;\r\n        width: 300px;\r\n    }\r\n    .tab {\r\n        flex-grow: 1;\r\n    }\r\n    .tab button {\r\n        height: 1.5rem;\r\n        width: 100%;\r\n    }\r\n    .tab:first-of-type button {\r\n        border-left-width: 1px;\r\n        border-radius: 5px 0 0 5px;\r\n    }\r\n    .tab:last-of-type button {\r\n        border-radius: 0 5px 5px 0;\r\n    }\r\n    .dark button {\r\n        background: $dark-button-bg-inactive;\r\n        border: 1px solid $dark-button-border;\r\n        border-left-width: 0;\r\n        color: $dark-text-color;\r\n\r\n        &.active {\r\n            background: $dark-button-bg-active;\r\n            color: $dark-button-text-color-active;\r\n        }\r\n    }\r\n    .light button {\r\n        background: $light-button-bg-inactive;\r\n        border: 1px solid $light-button-border;\r\n        border-left-width: 0;\r\n        color: $light-text-color;\r\n\r\n        &.active {\r\n            background: $light-button-bg-active;\r\n            color: $light-button-text-color-active;\r\n        }\r\n    }\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tabs.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tabs.vue?vue&type=script&lang=js&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{class:{ active: _vm.isActive },attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.onClick($event)}}},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <button \r\n        :class=\"{ active: isActive }\" \r\n        @click.prevent.stop=\"onClick\" \r\n        type=\"button\"\r\n    >\r\n        <slot></slot>\r\n    </button>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: \"Tab\",\r\n    props: {\r\n      title: {\r\n        type: String,\r\n        required: true\r\n      }\r\n    },\r\n    computed: {\r\n        isActive() {\r\n            return this.$parent.activeTab == this.title;\r\n        }\r\n    },\r\n    methods: {\r\n        onClick(e) {\r\n            this.$parent.$emit(\"tab-click\", this.title);\r\n        }\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tab.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tab.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./tab.vue?vue&type=template&id=6ad1e604&\"\nimport script from \"./tab.vue?vue&type=script&lang=js&\"\nexport * from \"./tab.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('validation-observer',{ref:\"observer\",attrs:{\"slim\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar handleSubmit = ref.handleSubmit;\nreturn [_c('form',{staticClass:\"main-controls my2\",on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }$event.preventDefault();},\"submit\":function($event){$event.preventDefault();return handleSubmit(_vm.onPipelineRun)}}},[_c('div',{staticClass:\"main-controls__controls mb2\"},[_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isStopped),expression:\"isStopped\"}],staticClass:\"topcoat-button--large\",attrs:{\"type\":\"submit\",\"title\":\"Run all pipelines on the selected source.\"}},[_vm._v(\"▶\")]),_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isPaused),expression:\"isPaused\"}],staticClass:\"topcoat-button--large\",attrs:{\"type\":\"button\",\"title\":\"Resume processing.\"},on:{\"click\":_vm.onPipelineResume}},[_vm._v(\"Resume\")]),_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.canPause),expression:\"canPause\"}],staticClass:\"topcoat-button--large\",attrs:{\"type\":\"button\",\"title\":\"Pause processing.\"},on:{\"click\":_vm.onPipelinePause}},[_vm._v(\"❚❚\")]),_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isStopped),expression:\"!isStopped\"}],staticClass:\"topcoat-button--large\",attrs:{\"type\":\"button\",\"title\":\"Stop all pipelines and file sources.\"},on:{\"click\":_vm.onPipelineStop}},[_vm._v(\"◼\")])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isMainDrawerOpen),expression:\"isMainDrawerOpen\"}],staticClass:\"main-controls__drawer columns\"},[_c('div',{staticClass:\"column is-half-tablet\"},[_c('h3',{staticClass:\"section-title\"},[_vm._v(\"Pipelines Status\")]),_c('div',[_vm._v(_vm._s(_vm.pipelineEngineStateText))]),(_vm.pipelinefilePathText)?_c('h3',{staticClass:\"section-title\"},[_vm._v(\"Current Source Path\")]):_vm._e(),_c('div',[_vm._v(_vm._s(_vm.pipelinefilePathText))])]),_c('div',{staticClass:\"column is-half-tablet\"},[_c('h3',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pipelineText),expression:\"pipelineText\"}],staticClass:\"section-title\"},[_vm._v(\"Pipeline\")]),_c('div',[_vm._v(_vm._s(_vm.pipelineText))]),_c('h3',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pipelineActionText),expression:\"pipelineActionText\"}],staticClass:\"section-title\"},[_vm._v(\"Action\")]),_c('div',[_vm._v(_vm._s(_vm.pipelineActionText))])])]),_c('div',{staticClass:\"main-controls__drawer-toggle\",class:{ active: _vm.isMainDrawerOpen }},[_c('button',{staticClass:\"topcoat-button--large\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.isMainDrawerOpen = !_vm.isMainDrawerOpen}}},[_vm._v(\"Source & Status \"),_c('span',[_vm._v(\"❱\")])])])])]}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <validation-observer \r\n        ref=\"observer\"\r\n        slim\r\n        v-slot=\"{ handleSubmit }\"\r\n    >\r\n        <form \r\n            class=\"main-controls my2\"\r\n            @keydown.enter.prevent\r\n            @submit.prevent=\"handleSubmit(onPipelineRun)\"\r\n        >\r\n            <div class=\"main-controls__controls mb2\">\r\n                <button class=\"topcoat-button--large\" \r\n                    type=\"submit\"\r\n                    title=\"Run all pipelines on the selected source.\"\r\n                    v-show=\"isStopped\">&#9654;</button>\r\n                <button class=\"topcoat-button--large\" \r\n                    type=\"button\"\r\n                    @click=\"onPipelineResume\"\r\n                    title=\"Resume processing.\"\r\n                    v-show=\"isPaused\">Resume</button>\r\n                <button class=\"topcoat-button--large\" \r\n                    type=\"button\"\r\n                    @click=\"onPipelinePause\"\r\n                    title=\"Pause processing.\"\r\n                    v-show=\"canPause\">&#10074;&#10074;</button>\r\n                <button class=\"topcoat-button--large\" \r\n                    type=\"button\"\r\n                    @click=\"onPipelineStop\"\r\n                    title=\"Stop all pipelines and file sources.\"\r\n                    v-show=\"!isStopped\" \r\n                    >&#9724;</button>\r\n            </div>\r\n            <div class=\"main-controls__drawer columns\" \r\n                v-show=\"isMainDrawerOpen\"\r\n            >\r\n                <div class=\"column is-half-tablet\">\r\n                    <h3 class=\"section-title\">Pipelines Status</h3>\r\n                    <div>{{ pipelineEngineStateText }}</div>\r\n                    <h3 class=\"section-title\" v-if=\"pipelinefilePathText\">Current Source Path</h3>\r\n                    <div>{{ pipelinefilePathText }}</div>\r\n                    <!-- <div v-if=\"isInitializing\">Initializing<wait-dots/></div> -->\r\n                </div>\r\n                <div class=\"column is-half-tablet\">\r\n                    <h3 class=\"section-title\" v-show=\"pipelineText\">Pipeline</h3>\r\n                    <div>{{ pipelineText }}</div>\r\n                    <h3 class=\"section-title\" v-show=\"pipelineActionText\">Action</h3>\r\n                    <div>{{ pipelineActionText }}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"main-controls__drawer-toggle\" :class=\"{ active: isMainDrawerOpen }\">\r\n                <button \r\n                    class=\"topcoat-button--large\" \r\n                    type=\"button\"\r\n                    @click=\"isMainDrawerOpen = !isMainDrawerOpen\"\r\n                >Source &amp; Status <span>❱</span></button>\r\n            </div>\r\n        </form>\r\n    </validation-observer>\r\n</template>\r\n\r\n<script>\r\nimport { ValidationProvider, ValidationObserver } from \"vee-validate\";\r\n\r\nimport _ from \"../utils\";\r\nimport store from \"../store\"; \r\nimport eventBus from \"../eventBus\";\r\nimport Server from '../server';\r\nimport PipelineEngineState from '../server/pipelineEngineState';\r\nimport WaitDots from './wait-dots.vue';\r\n\r\nexport default {\r\n    name: 'MainControls',\r\n    components: {\r\n        ValidationObserver,\r\n        ValidationProvider,\r\n        WaitDots\r\n    },\r\n    data() {\r\n        return {\r\n            pipelineEngineState: Server.pipelineEngine.state,\r\n            pipelineText: \"\",\r\n            pipelineActionText: \"\",\r\n            pipelinefilePathText: \"\",\r\n            isMainDrawerOpen: store.general.isMainDrawerOpen\r\n        }\r\n    },\r\n    watch: {\r\n        isMainDrawerOpen: v => { \r\n            store.general.isMainDrawerOpen = v; \r\n            store.general.save();\r\n        }\r\n        // imageSource: {\r\n        //     deep: true, \r\n        //     handler: function(v) {\r\n        //         store.general.imageSource = v;\r\n        //     }\r\n        // }\r\n    },\r\n    computed: {\r\n        canPause() {\r\n            return this.pipelineEngineState == PipelineEngineState.IDLE \r\n                || this.pipelineEngineState == PipelineEngineState.PROCESSING;\r\n        },\r\n        isStopped() {\r\n            return this.pipelineEngineState == PipelineEngineState.STOPPED;\r\n        },\r\n        isPaused() {\r\n            return this.pipelineEngineState == PipelineEngineState.PAUSED;\r\n        },\r\n        isProcessing() {\r\n            return this.pipelineEngineState == PipelineEngineState.PROCESSING;\r\n        },\r\n        pipelineEngineStateText() {\r\n            return PipelineEngineState.toKey(this.pipelineEngineState);\r\n        }\r\n    },\r\n    created() \r\n    {\r\n        eventBus.$on(\"pipeline-play\", pipelineName => {\r\n            Server.pipelineEngine.run(pipelineName);\r\n        });\r\n        Server.pipelineEngine.on(\"state\", state => {\r\n            this.pipelineEngineState = state;\r\n        });\r\n        Server.pipelineEngine.on(\"status\", status => {\r\n            this.pipelineText = status.pipeline;\r\n            this.pipelineActionText = status.action;\r\n            this.pipelinefilePathText = status.file;\r\n        });\r\n    },\r\n    methods: {\r\n        /**\r\n         * Submit handler\r\n         */\r\n        onPipelineRun() {\r\n            this.$dialog.openConfirm({\r\n                name: \"confirm\",\r\n                message: \"This will run all pipelines with their configured sources. Continue?\",\r\n                onYes: () => {\r\n                    Server.pipelineEngine.runAll();\r\n                }\r\n            });\r\n        },\r\n        onPipelineResume() {\r\n            Server.pipelineEngine.resume();\r\n        },\r\n        onPipelinePause() {\r\n            Server.pipelineEngine.pause();\r\n        },\r\n        onPipelineStop() {\r\n            Server.pipelineEngine.stop();\r\n        }\r\n    }\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./main-controls.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./main-controls.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./main-controls.vue?vue&type=template&id=52f18958&\"\nimport script from \"./main-controls.vue?vue&type=script&lang=js&\"\nexport * from \"./main-controls.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div id=\"app\">\r\n    <a-dialog-root />\r\n    <adobe-menus />\r\n    \r\n    <tabs @changed=\"onTabChanged\" :initial-tab=\"currentTabComponent\">\r\n        <tab title=\"the-console\">Console</tab>\r\n        <tab title=\"the-jsx-runner\">Jsx</tab>\r\n        <tab title=\"the-configurator\">Configuration</tab>\r\n        <tab title=\"the-pipelines\">Pipelines</tab>\r\n    </tabs>\r\n\r\n    <main-controls />\r\n\r\n    <section class=\"tab-content\">\r\n        <keep-alive>\r\n            <component :is=\"currentTabComponent\"></component>\r\n        </keep-alive>\r\n    </section>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/* Can also use cep_node.require */\r\n/* npm modules */ \r\nimport upath from 'upath'; \r\n\r\n/* local modules */\r\nimport store from './store';\r\nimport themeManager from \"./themeManager\";\r\nimport Tabs from './components/tabs.vue';\r\nimport Tab from './components/tab.vue';\r\nimport MainControls from './components/main-controls.vue';\r\n\r\nexport default {\r\n    name: \"app\",\r\n    components: {\r\n        MainControls,\r\n        Tabs, \r\n        Tab,\r\n        AdobeMenus: () => import(\"./components/adobe-menus.vue\"),\r\n        TheConsole: () => import('./components/the-console.vue'),\r\n        TheJsxRunner: () => import(\"./components/the-jsx-runner.vue\"),\r\n        TheConfigurator: () => import(\"./components/the-configurator.vue\"),\r\n        ThePipelines: () => import(\"./components/the-pipelines.vue\")\r\n    },\r\n    data: () => {\r\n        return {\r\n            currentTabComponent: store.general.currentTab\r\n        }\r\n    },\r\n    mounted() {\r\n        themeManager.init();\r\n        this.hideLoadingSpinner();\r\n    },\r\n    methods: {\r\n        onTabChanged(tabTitle) {\r\n            store.general.currentTab = tabTitle;\r\n            store.general.save();\r\n            this.currentTabComponent = tabTitle;\r\n        },\r\n        hideLoadingSpinner() {\r\n            let spinnerEl = document.getElementById(\"loading\");\r\n            if (spinnerEl) \r\n                spinnerEl.style.display = \"none\";\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n/* Various helper styles to match application theme */\r\n@import url(\"http://fonts.googleapis.com/css?family=Source+Sans+Pro:300\");\r\n@import url(\"http://fonts.googleapis.com/css?family=Source+Code+Pro\");\r\n@import \"./styles/columns\";\r\n\r\n\r\n\r\nhtml, body {\r\n    font-size: 14px;\r\n    margin: 0;\r\n    padding: 0;\r\n    height: 100%;\r\n}\r\nbody {\r\n    font-family: source-sans-pro, sans-serif;\r\n    line-height: 1.5rem;\r\n\r\n    &.light {\r\n        background: #F4F4F4;\r\n        color: #181919;\r\n    }\r\n    &.dark {\r\n        color: $dark-text-color;\r\n        background: $dark-bg;\r\n    }\r\n    * {\r\n        box-sizing: border-box;\r\n    }\r\n}\r\n\r\nh1, h2, h3 {\r\n    margin: 0 0 0.5em 0;\r\n}\r\nh1 {\r\n    font-size: 20px;\r\n    font-weight: 600;\r\n    margin: 0.5em;\r\n}\r\nh2 {\r\n    font-size: 16px;\r\n    font-weight: 300;\r\n}\r\nh3 {\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n}\r\nh4 {\r\n    font-size: 12px; \r\n    font-weight: 400;\r\n}\r\n.dark .text-highlight {\r\n    color: $dark-text-highlight-color;\r\n}\r\n\r\n\r\n#app {\r\n    display: flex;\r\n    flex-direction: column;\r\n    width: 100%;\r\n}\r\n\r\n.tab-title {\r\n    font-weight: bold;\r\n    padding: .25rem .5rem;\r\n    left: -.5rem;\r\n    position: relative;\r\n    width: 100vw;\r\n\r\n    @at-root .dark & {\r\n        background: #424242;\r\n    }\r\n}\r\n.tab-content {\r\n    flex-grow: 1;\r\n    flex-shrink: 1;\r\n    padding: .5rem;\r\n}\r\n.section-title {\r\n    font-weight: bold;\r\n    margin: .5rem 0 0 0;\r\n    padding: .25rem 0;\r\n}\r\n.section-content {\r\n    padding: 0;\r\n}\r\n.section-content--inset {\r\n    background: rgba(0,0,0,0.2);\r\n    border: none;\r\n    border-radius: 7px;\r\n    padding: 1rem;\r\n}\r\n\r\n\r\n#app::-webkit-scrollbar {\r\n  display: block;\r\n}\r\nbody::-webkit-scrollbar {\r\n  width: 0px;\r\n}\r\n::-webkit-scrollbar-resizer {\r\n  display: none;\r\n  width: 0px;\r\n  background-color: transparent;\r\n}\r\n::-webkit-scrollbar-button {\r\n  height: 0px;\r\n}\r\n::-webkit-scrollbar-corner {\r\n  display: none;\r\n}\r\ninput[type=number] {\r\n    -moz-appearance:textfield;\r\n}\r\n::-webkit-outer-spin-button,\r\n::-webkit-inner-spin-button {\r\n    -webkit-appearance: none;\r\n    margin: 0;\r\n}\r\n//-------------------\r\n// Utilities\r\n//-------------------\r\n@mixin clearfix() {\r\n  &::after {\r\n    display: block;\r\n    content: \"\";\r\n    clear: both;\r\n  }\r\n}\r\n.clearfix {\r\n    @include clearfix();\r\n}\r\n.flex {\r\n    display: flex;\r\n}\r\n.flex-grow {\r\n    flex-grow: 1;\r\n}\r\n.full-width {\r\n    width: 100%;\r\n}\r\n\r\n$space-1: $column-gap;\r\n$space-2: $column-gap * 2;\r\n\r\n.m0  { margin:        0 }\r\n.mt0 { margin-top:    0 }\r\n.mr0 { margin-right:  0 }\r\n.mb0 { margin-bottom: 0 }\r\n.ml0 { margin-left:   0 }\r\n.mx0 { margin-left:   0; margin-right:  0 }\r\n.my0 { margin-top:    0; margin-bottom: 0 }\r\n\r\n.m1  { margin:        $space-1 }\r\n.mt1 { margin-top:    $space-1 }\r\n.mr1 { margin-right:  $space-1 }\r\n.mb1 { margin-bottom: $space-1 }\r\n.ml1 { margin-left:   $space-1 }\r\n.mx1 { margin-left:   $space-1; margin-right:  $space-1 }\r\n.my1 { margin-top:    $space-1; margin-bottom: $space-1 }\r\n\r\n.m2  { margin:        $space-2 }\r\n.mt2 { margin-top:    $space-2 }\r\n.mr2 { margin-right:  $space-2 }\r\n.mb2 { margin-bottom: $space-2 }\r\n.ml2 { margin-left:   $space-2 }\r\n.mx2 { margin-left:   $space-2; margin-right:  $space-2 }\r\n.my2 { margin-top:    $space-2; margin-bottom: $space-2 }\r\n\r\n.ml-auto { margin-left: auto }\r\n.mr-auto { margin-right: auto }\r\n.mx-auto { margin-left: auto; margin-right: auto; }\r\n\r\n.left {\r\n    float: left;\r\n}\r\n.right {\r\n    float: right;\r\n}\r\n\r\n//-------------------\r\n// Topcoat Overrides\r\n//-------------------\r\n.topcoat-checkbox,\r\n.topcoat-text-input {\r\n    line-height: 1.5rem;\r\n}\r\n.topcoat-checkbox {\r\n    display: flex;\r\n    align-items: center;\r\n    margin: $column-gap 0;\r\n\r\n    &__checkmark {\r\n        margin-right: .5rem;\r\n    }\r\n}\r\n.topcoat-notification {\r\n    min-width: 24px;\r\n}\r\n.topcoat-notification.error {\r\n    bottom: 0;\r\n    opacity: .9;\r\n    overflow: visible;\r\n    position: absolute;\r\n    right: 0;\r\n    transform: translateY(100%);\r\n    z-index: 1;\r\n\r\n    &::after {\r\n        content: '\\25B6';\r\n        color: #ec514e;\r\n        font-size: 18px;\r\n        position: absolute;\r\n        right: 8px;\r\n        top: -16px;\r\n        transform: rotateZ(-90deg);\r\n    }\r\n}\r\n\r\nlabel {\r\n    display: block;\r\n    position: relative;\r\n}\r\n.label {\r\n    margin-bottom: .25rem;    \r\n}\r\n\r\n\r\n.main-controls {\r\n    z-index: 1;\r\n\r\n    &__controls {\r\n        text-align: center;\r\n    }\r\n    &__drawer {\r\n        background: rgba(0,0,0,0.2);\r\n        box-shadow: inset 0px 0px 8px 2px rgba(0, 0, 0, 0.2);\r\n        // max-height: 1000px;\r\n        overflow: hidden;\r\n        padding: .5rem .5rem 2rem .5rem;\r\n        \r\n        // &.v-enter-active,\r\n        // &.v-leave-active {\r\n        //     transition: max-height 0.4s;\r\n        // }\r\n        // &.v-enter,\r\n        // &.v-leave-to {\r\n        //     max-height: 0;\r\n        // }\r\n    }\r\n    &__drawer-toggle {\r\n        height: 0;\r\n        text-align: center;\r\n\r\n        button {\r\n            box-shadow: none !important;\r\n            border: inherit !important;\r\n        }\r\n        & span {\r\n            display: inline-block;\r\n            margin: 0  $column-gap * 2;\r\n            transform: rotateZ(90deg);\r\n        }\r\n        &.active span {\r\n            transform: rotateZ(-90deg);\r\n        }\r\n    }\r\n}\r\n\r\n.source,\r\n.pipeline {\r\n    background: rgba(0,0,0,0.2);\r\n    border: none;\r\n    border-bottom: 1px solid #333;\r\n    border-radius: 7px;\r\n    padding: 1rem;\r\n    margin-bottom: .5rem;\r\n\r\n    label {\r\n        position: relative;\r\n    }\r\n    label:not(.topcoat-checkbox) {\r\n        display: block;\r\n        margin-bottom: $column-gap;\r\n    }\r\n    &:last-of-type {\r\n        margin-bottom: ($column-gap * 2);\r\n    }\r\n}\r\n\r\n.configurator-buttons,\r\n.pipeline-buttons {\r\n    margin: ($column-gap * 2) 0;\r\n\r\n    button {\r\n        margin-right: .5rem;\r\n    }\r\n}\r\n\r\n.pipeline {\r\n    &.disabled {\r\n        background: rgba(255,0,0,0.03);\r\n    }\r\n}\r\n\r\n.pipeline-body,\r\n.source-body {\r\n    padding-left: 2rem;\r\n}\r\n/*\r\n    -----------------------------------------------\r\n    | Handle | Expand | Data                      |\r\n    |        |        | Name (Name | X)  |\r\n    |        |        | Parameters                |\r\n    _______________________________________________\r\n*/\r\n.action {\r\n    align-items: flex-start;\r\n    display: flex;\r\n    flex-wrap: nowrap;\r\n    justify-content: flex-start;\r\n}\r\n\r\n.action {\r\n    border: none;\r\n    border-bottom: 1px solid #333;\r\n    padding: ($column-gap * 2);\r\n\r\n    label {\r\n        position: relative;\r\n    }\r\n    label:not(.topcoat-checkbox) {\r\n        display: block;\r\n        margin-bottom: $column-gap;\r\n    }\r\n    &:last-of-type {\r\n        margin-bottom: ($column-gap * 2);\r\n    }\r\n}\r\n\r\n.pipeline-handle,\r\n.action-handle,\r\n.source-handle,\r\n.expand {\r\n    padding-left: $column-gap * 2;\r\n    padding-right: $column-gap * 2;\r\n}\r\n.pipeline-handle,\r\n.action-handle,\r\n.source-handle {\r\n    cursor: row-resize;\r\n}\r\n.expand {\r\n    cursor: pointer;\r\n    i {\r\n        font-style: normal;\r\n    }\r\n    &.open {\r\n        transform: rotateZ(90deg);\r\n    }\r\n}\r\n\r\n.action-data {\r\n    display: block;\r\n    flex-grow: 1;\r\n}\r\n.action-data {\r\n    .action-name {\r\n        display: flex;\r\n        width: 100%;\r\n        input[type=text] {\r\n            flex-grow: 1;\r\n        }\r\n    }\r\n    .action-parameters {\r\n        display: flex;\r\n        flex-direction: column;\r\n        width: 100%;\r\n\r\n        h3 {\r\n            margin: $column-gap 0;\r\n        }\r\n    }\r\n    .action-parameter {\r\n        display: flex;\r\n        margin-bottom: $column-gap;\r\n\r\n        &__input {\r\n            flex-grow: 1;\r\n        }\r\n        input {\r\n            width: 100%;\r\n        }\r\n    }\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./app.vue?vue&type=template&id=50c0a8cf&\"\nimport script from \"./app.vue?vue&type=script&lang=js&\"\nexport * from \"./app.vue?vue&type=script&lang=js&\"\nimport style0 from \"./app.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-dialog',{attrs:{\"isOpen\":_vm.isOpen,\"width\":_vm.width,\"height\":_vm.height,\"maxWidth\":_vm.maxWidth,\"maxHeight\":_vm.maxHeight},on:{\"onBackdropClose\":_vm.backdropClose}},[_c(_vm.component,_vm._g(_vm._b({tag:\"component\",on:{\"onClose\":_vm.close}},'component',_vm.props,false),_vm.listeners))],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue'\n\nexport const events = new Vue({ name: 'a-dialog' })","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"name\":\"modal-fade\"}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isOpen),expression:\"isOpen\"}],staticClass:\"modal-backdrop\",class:{open: _vm.isOpen},on:{\"click\":_vm.onClose}},[_c('div',{ref:\"modal\",staticClass:\"modal\",style:({ height: _vm.height, width: _vm.width, maxHeight: _vm.maxHeight, maxWidth: _vm.maxWidth }),on:{\"click\":function($event){$event.stopPropagation();}}},[_vm._t(\"default\")],2)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <transition name=\"modal-fade\">\r\n        <div class=\"modal-backdrop\" \r\n            :class=\"{open: isOpen}\"\r\n            @click=\"onClose\"\r\n            v-show=\"isOpen\">\r\n            <div class=\"modal\" v-bind:style=\"{ height, width, maxHeight, maxWidth }\" @click.stop ref=\"modal\">\r\n                <slot />\r\n            </div>\r\n        </div>\r\n    </transition>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: \"ADialog\",\r\n    props: {\r\n        isOpen: Boolean,\r\n        width: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        height: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        maxWidth: {\r\n            type: String,\r\n            required: false\r\n        },\r\n        maxHeight: {\r\n            type: String,\r\n            required: false\r\n        }\r\n    },\r\n    watch: {\r\n        isOpen(value) {\r\n            if(!value) {\r\n                return;\r\n            }\r\n            this.$nextTick(() => {\r\n                this.setModalBodyHeight();\r\n            })\r\n        }\r\n    },\r\n    methods: {\r\n        onClose() {\r\n            this.$emit('onBackdropClose');\r\n        },\r\n        setModalBodyHeight()\r\n        {\r\n            const headerEl = this.$el.querySelector(\".modal-header\");\r\n            const bodyEl = this.$el.querySelector(\".modal-body\");\r\n            const footerEl = this.$el.querySelector(\".modal-footer\");\r\n            const modalStyle = window.getComputedStyle(this.$refs.modal);\r\n            const modalHeight = parseInt(modalStyle.height, 10);\r\n            const modalPadding = parseInt(modalStyle.paddingTop, 10) + parseInt(modalStyle.paddingBottom, 10);\r\n            const headerHeight = headerEl ? headerEl.clientHeight : 0;\r\n            const footerHeight = footerEl ? footerEl.clientHeight : 0;\r\n\r\n            if(bodyEl) {\r\n                bodyEl.style.maxHeight = ((modalHeight - modalPadding) - (headerHeight + footerHeight)) + \"px\";\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./a-dialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./a-dialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./a-dialog.vue?vue&type=template&id=2c097f5c&\"\nimport script from \"./a-dialog.vue?vue&type=script&lang=js&\"\nexport * from \"./a-dialog.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('section',{staticClass:\"modal-body\"},[_vm._v(\" \"+_vm._s(_vm.message)+\" \")]),_c('footer',{staticClass:\"modal-footer\"},[_vm._t(\"footer\",[_c('button',{staticClass:\"topcoat-button--large\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.$emit('onClose', true)}}},[_vm._v(\" Yes \")]),_c('button',{staticClass:\"topcoat-button--large\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.$emit('onClose', false)}}},[_vm._v(\" Cancel \")])])],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div>\r\n        <section class=\"modal-body\">\r\n            {{ message }}\r\n        </section>\r\n        <footer class=\"modal-footer\">\r\n            <slot name=\"footer\">\r\n                <button type=\"button\" class=\"topcoat-button--large\" @click=\"$emit('onClose', true)\">\r\n                    Yes\r\n                </button>\r\n                <button type=\"button\" class=\"topcoat-button--large\" @click=\"$emit('onClose', false)\">\r\n                    Cancel\r\n                </button>\r\n            </slot>\r\n        </footer>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: \"Confirm\",\r\n    props: {\r\n        message: {\r\n            type: String, \r\n            required: true\r\n        }\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./confirm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./confirm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./confirm.vue?vue&type=template&id=1b1723f6&\"\nimport script from \"./confirm.vue?vue&type=script&lang=js&\"\nexport * from \"./confirm.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <a-dialog \r\n        :isOpen=\"isOpen\" \r\n        :width=\"width\" \r\n        :height=\"height\" \r\n        :maxWidth=\"maxWidth\" \r\n        :maxHeight=\"maxHeight\"\r\n        @onBackdropClose=\"backdropClose\"\r\n    >\r\n        <component \r\n            :is=\"component\" \r\n            v-bind=\"props\" \r\n            v-on=\"listeners\" \r\n            @onClose=\"close\" />\r\n    </a-dialog>\r\n</template>\r\n\r\n<script>\r\nimport {events} from './events';\r\nimport ADialog from './a-dialog.vue';\r\nimport Confirm from './confirm.vue';\r\n\r\nconst defaultOptions = {\r\n    height: \"auto\",\r\n    width: \"80%\",\r\n    maxWidth: \"80%\",\r\n    maxHeight: \"80%\"\r\n};\r\n\r\nexport default {\r\n    name: 'ADialogRoot',\r\n    components: {\r\n        ADialog\r\n    },\r\n    data: () => ({\r\n        component: null,\r\n        width: \"\",\r\n        height: \"\",\r\n        maxWidth: \"\",\r\n        maxHeight: \"\",\r\n        props: null,\r\n        listeners: null\r\n    }),\r\n    computed: {\r\n        isOpen() {\r\n            return !!this.component;\r\n        }\r\n    },\r\n    mounted () {\r\n        events.$on('openconfirm', this.openConfirm);\r\n        events.$on('open', this.open);\r\n        events.$on('close', this.close);\r\n    },\r\n    methods: {\r\n        openConfirm({ onYes, onCancel, message, ...args }) \r\n        {\r\n            this.open({ \r\n                component: Confirm, \r\n                listeners: {\r\n                    onClose: (isYes) => {\r\n                        if(isYes)\r\n                            onYes && onYes();\r\n                        else \r\n                            onCancel && onCancel();\r\n                    }\r\n                },\r\n                props: {\r\n                    message\r\n                },\r\n                ...args\r\n            });\r\n        },\r\n        open({ width, height, maxWidth, maxHeight, component, props = null, listeners = null }) \r\n        {\r\n            if(this.isOpen) {\r\n                console.warn(\"Dialog already open. Ignoring open: \" + component.name);\r\n                return;\r\n            }\r\n            console.log(`Dialog open.`);\r\n\r\n            this.width = width || defaultOptions.width;\r\n            this.height = height || defaultOptions.height;\r\n            this.maxWidth = maxWidth || defaultOptions.maxWidth;\r\n            this.maxHeight = maxHeight || defaultOptions.maxHeight;\r\n            this.component = component;\r\n            this.props = props;\r\n            this.listeners = listeners;\r\n        },\r\n        backdropClose() {\r\n            // Force close\r\n            if(this.listeners && this.listeners.onClose) {\r\n                this.listeners.onClose();\r\n            }\r\n            this.close();\r\n        },\r\n        /**\r\n         * IMPORTANT: Should only be called by child component 'onClose' event.\r\n         * Otherwise previous open() calls could be left hanging (e.g. waiting for a callback)\r\n         */\r\n        close() {\r\n            console.log(`Dialog close.`);\r\n\r\n            this.component = null;\r\n            this.props = null;\r\n            this.listeners = null;\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n    .modal-backdrop {\r\n        position: fixed;\r\n        top: 0;\r\n        bottom: 0;\r\n        left: 0;\r\n        right: 0;\r\n        background-color: rgba(0, 0, 0, 0.4);\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        z-index: 2;\r\n    }\r\n\r\n    .modal {\r\n        background: #444;\r\n        overflow-x: auto;\r\n        display: flex;\r\n        flex-direction: column;\r\n        padding: 1rem;\r\n    }\r\n\r\n    .modal-body {\r\n        min-height: 3rem;\r\n        overflow: auto;\r\n        padding: .25rem;\r\n        position: relative;\r\n    }\r\n\r\n    .modal-header {\r\n        padding-bottom: 1rem;\r\n    }\r\n\r\n    .modal-footer {\r\n        display: flex;\r\n        justify-content: flex-start;\r\n        padding-top: 1rem;\r\n    }\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./a-dialog-root.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./a-dialog-root.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./a-dialog-root.vue?vue&type=template&id=1bc09963&\"\nimport script from \"./a-dialog-root.vue?vue&type=script&lang=js&\"\nexport * from \"./a-dialog-root.vue?vue&type=script&lang=js&\"\nimport style0 from \"./a-dialog-root.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import ADialogRoot from './a-dialog-root.vue';\r\nimport {events} from './events';\r\n\r\nconst Plugin = {\r\n    install (Vue, globalOptions = {}) \r\n    {\r\n        Vue.prototype.$dialog = {\r\n            /**\r\n             * Opens a simple message confirmation dialog\r\n             * @param {string} message message to display\r\n             * @param {function} onYes callback for Yes answer\r\n             * @param {function} onCancel callback for Cancel answer\r\n             */\r\n            openConfirm(options) {\r\n                events.$emit('openconfirm', options);\r\n            },\r\n            open (options) {\r\n                events.$emit('open', options);\r\n            }\r\n        };\r\n\r\n        Vue.component('ADialogRoot', ADialogRoot)\r\n    }\r\n}\r\n  \r\nexport default Plugin","import fs from 'fs';\r\nimport upath from 'upath';\r\nimport { configure, setInteractionMode, extend } from 'vee-validate';\r\nimport _ from '../utils';\r\n\r\nsetInteractionMode(\"custom\", context => {\r\n    return {\r\n        on: [\"change\", \"blur\"]\r\n    }\r\n});\r\n\r\nextend(\"integer\", {\r\n    validate(value, { min, max }) {\r\n        value = parseInt(value, 10);\r\n        min = parseInt(min, 10);\r\n        max = parseInt(max, 10);\r\n\r\n        let message = `Must be an integer`;\r\n        if(_.isNumber(min) && _.isNumber(max)) {\r\n            message += ` between ${min} and ${max}`;\r\n        } else if(_.isNumber(min)) {\r\n            message += ` greater than or equal to ${min}`;\r\n        } else if(_.isNumber(max)) {\r\n            message += ` less than or equal to ${max}`;\r\n        }\r\n        if(!_.isNumber(value)) {\r\n            return message;\r\n        }\r\n        if(_.isNumber(min) && value < min) {\r\n            return message;\r\n        }\r\n        if(_.isNumber(max) && value > max) {\r\n            return message;\r\n        }\r\n        return true;\r\n    },\r\n    params: ['min', 'max']\r\n})\r\n\r\nextend('required', {\r\n    validate (value) {\r\n        return {\r\n            required: true,\r\n            valid: ['', null, undefined].indexOf(value) === -1 && !(Array.isArray(value) && value.length === 0)\r\n        };\r\n    },\r\n    message: 'This is required',\r\n    computesRequired: true\r\n});\r\n\r\nextend('pathexists', { \r\n    async validate(value) \r\n    {\r\n        const exists = await new Promise(resolve => {\r\n            fs.access(value, error => {\r\n                resolve(!error);\r\n            });\r\n        });\r\n        if(exists) {\r\n            return true;\r\n        }\r\n        return {\r\n            valid: false\r\n        }\r\n    },\r\n    message: \"Path does not exist\"\r\n});\r\n\r\nextend('pathunc', {\r\n    validate(value, args) {\r\n        const allowed = typeof args.allowed === \"boolean\" ? args.allowed : JSON.parse(args.allowed.toLowerCase());\r\n        const path = value.trim();\r\n        const isUnc = path.startsWith(\"//\") || path.startsWith(\"\\\\\\\\\");\r\n        return !(isUnc && !allowed)\r\n    },\r\n    params: ['allowed'],\r\n    message: `Path cannot be a UNC path.`\r\n})\r\n\r\nextend('pathrelative', {\r\n    validate(value, args) {\r\n        const allowed = typeof args.allowed === \"boolean\" ? args.allowed : JSON.parse(args.allowed.toLowerCase());\r\n        const path = value.trim();\r\n        if(!allowed) {\r\n            return upath.isAbsolute(path);\r\n        }\r\n        return true;\r\n    },\r\n    params: ['allowed'],\r\n    message: `Path must be absolute.`\r\n})\r\n\r\nextend('custom', {\r\n    params: ['fn'],\r\n    validate(value, params) {\r\n        const result = params.fn(value);\r\n        return result.valid ? result.valid : result.message;\r\n    }\r\n});\r\n\r\nconsole.log(\"Validation imported\");\r\nexport default { \r\n    init: () => {\r\n        return Promise.resolve();\r\n    } \r\n};\r\n\r\n\r\n// extend(\"uniq\", {\r\n//     validate: async value => {\r\n//       const response = await checkEmail(value);\r\n  \r\n//       if (response.valid) {\r\n//         return true;\r\n//       }\r\n  \r\n//       return {\r\n//         valid: false,\r\n//         data: {\r\n//           // this will be used to interpolate the message.\r\n//           serverMessage: response.errors[0]\r\n//         }\r\n//       };\r\n//     },\r\n//     // same prop as returned in the `data` object.\r\n//     message: `{serverMessage}`\r\n// });\r\n\r\n// /**\r\n//  * Master validation instance. Keeps track of validation components and their validity. \r\n//  * Should be imported at root <form> component and instance passed down to child components.\r\n//  */\r\n// class Validation\r\n// {\r\n//     constructor(root) {\r\n//         this.root = root;\r\n//         this.validatorComponents = [];\r\n//     }\r\n//     register(validator) \r\n//     {\r\n//         this.validatorComponents.push(validator);\r\n//     }\r\n//     unregister(validator) \r\n//     {\r\n//         this.validatorComponents = this.validatorComponents.filter(c => c !== validator);\r\n//     }\r\n//     isValid() {\r\n//         return this.validatorComponents.every(c => c.isValid());\r\n//     }\r\n// }\r\n// Validation.mixin = {\r\n//     directives: {\r\n//         \"errors\": {\r\n//             bind: function(el, binding, vnode) {\r\n//                 var s = JSON.stringify\r\n//                 el.innerHTML =\r\n//                 'name: '       + s(binding.name) + '<br>' +\r\n//                 'value: '      + s(binding.value) + '<br>' +\r\n//                 'expression: ' + s(binding.expression) + '<br>' +\r\n//                 'argument: '   + s(binding.arg) + '<br>' +\r\n//                 'modifiers: '  + s(binding.modifiers) + '<br>' +\r\n//                 'vnode keys: ' + Object.keys(vnode).join(', ')\r\n//             }\r\n//         }\r\n//     },\r\n//     props: {\r\n//         validation: Object\r\n//     },\r\n//     data() {\r\n//         return {\r\n//             errors: {}\r\n//         }\r\n//     },\r\n//     beforeCreate() { \r\n//         // Make errors observable\r\n//         this.$validator = new Validator(this.errors);  \r\n\r\n//         // Register with Master \r\n//         this.validation = this.validation || new Validation();\r\n//         this.validation.register(this.$validator);\r\n//     },\r\n//     beforeDestroy() {\r\n//         // Un-Register with Master \r\n//         this.validation.unregister(this.$validate);\r\n//     }\r\n// }\r\n// /**\r\n//  * Holds current component errors. An instance is created on each component using the Validation.mixin\r\n//  */\r\n// class Validator\r\n// {\r\n//     constructor(validationErrors) {\r\n//         this._validationErrors = validationErrors;\r\n//     }\r\n//     /**\r\n//      * Set the validity/message of a given field\r\n//      * @param {string} key the name of the form field \r\n//      * @param {*} message the validation message or empty if valid\r\n//      */\r\n//     pushError(key, message) \r\n//     {\r\n//         this._validationErrors[key] = message;\r\n//     }\r\n//     isValid() \r\n//     {\r\n//         return Object.values(this._validationErrors).filter(error => !!error).length == 0;\r\n//     }\r\n// }\r\n\r\n// export default Validation;  \r\n\r\n\r\n\r\n\r\n\r\n// Vue.directive(\"demo\", {\r\n//     bind: function(el, binding, vnode) {\r\n//         var s = JSON.stringify\r\n//         el.innerHTML =\r\n//         'name: '       + s(binding.name) + '<br>' +\r\n//         'value: '      + s(binding.value) + '<br>' +\r\n//         'expression: ' + s(binding.expression) + '<br>' +\r\n//         'argument: '   + s(binding.arg) + '<br>' +\r\n//         'modifiers: '  + s(binding.modifiers) + '<br>' +\r\n//         'vnode keys: ' + Object.keys(vnode).join(', ')\r\n//     }\r\n// });","import process from 'process';\r\nimport Vue from 'vue';\r\nimport App from './app.vue';\r\nimport Dialog from './dialog';\r\nimport Host from './host';\r\nimport HostScriptListener from './host/hostScriptListener';\r\nimport Logger from './console';\r\nimport Server from './server';\r\nimport global from './global';\r\nimport Validation from './validation';\r\nimport Store from './store';\r\n\r\nglobal.csInterface.setWindowTitle(\"Mario v\" + global.appVersion);\r\n\r\n// Fixes module resolution issues for dependencies within node_modules\r\nprocess.chdir(global.appWorkingPath);\r\n__dirname = global.appWorkingPath;\r\n\r\n\r\nVue.config.productionTip = false;\r\nVue.config.devtools = true;\r\nVue.use(Dialog);\r\n\r\nconst destroy = () => {\r\n    Server.destroy();\r\n    Host.destroy();\r\n    HostScriptListener.destroy();\r\n    Logger.destroy();\r\n};\r\n\r\nconst create = async () => {\r\n    await Store.init();\r\n    await Logger.init();\r\n    await Server.init();\r\n    await Host.init(); \r\n    await HostScriptListener.init();\r\n    await Validation.init();\r\n\r\n    window.vue = new Vue({\r\n        render: h => h(App),\r\n        beforeDestroy: destroy\r\n    }).$mount('#app');\r\n};\r\n\r\ncreate();\r\n\r\nwindow.addEventListener(\"beforeunload\", destroy);\r\n\r\n/**  \r\n    beforeCreate - about to be initialized. data is not yet reactive \r\n    created - events and data observation setup. not yet in native DOM. access data here, not in mounting hooks \r\n    beforeMount - right before render happens. template compiled and virtual DOM update by vue.  \r\n    mounted - $el added and native DOM updated. do modify DOM for integration of non-Vue libraries here.\r\n    beforeUpdate - data has changed and update cycle starting. do get data before actually is rendered. \r\n    updated - data changed and native DOM updated. do access DOM after property changes here. \r\n    beforeDestroy - about to teardown. still fully present and functional. do cleanup events, and subscriptions \r\n    destroyed - nothing left on your component. do last minute cleanups, etc. \r\n*/\r\n\r\n\r\n// Vue.directive(\"print\", {\r\n//     bind: function(el, binding, vnode) {\r\n//         var s = JSON.stringify\r\n//         el.innerHTML =\r\n//         'name: '       + s(binding.name) + '<br>' +\r\n//         'value: '      + s(binding.value) + '<br>' +\r\n//         'expression: ' + s(binding.expression) + '<br>' +\r\n//         'argument: '   + s(binding.arg) + '<br>' +\r\n//         'modifiers: '  + s(binding.modifiers) + '<br>' +\r\n//         'vnode keys: ' + Object.keys(vnode).join(', ')\r\n//     }\r\n// });","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=style&index=0&lang=scss&\"","import EventEmitter from \"events\";\r\nimport child_process from 'child_process';\r\n\r\n/**\r\n * @fires HostCallbackTunnelExec#enter immediately after exec() is called\r\n * @fires HostCallbackTunnelExec#exit when exec() callback is complete. this.close() is called immediately after this event.\r\n */\r\nexport default class HostCallbackTunnelExec extends EventEmitter\r\n{\r\n    constructor(cwd) \r\n    {\r\n        super();\r\n\r\n        this.cwd = cwd;\r\n        this.childProcess = null;\r\n        this.tunnelId = 0;\r\n    }\r\n    get name() {\r\n        return \"exec\";\r\n    }\r\n    getId() {\r\n        return this.tunnelId;\r\n    }\r\n    setId(id) {\r\n        this.tunnelId = id;\r\n    }\r\n    /**\r\n     * Execute the exec() tunnel\r\n     * @param {string} stream the raw parameters string (e.g. \"<callback id>, cp myFile.txt newFile.txt\")\r\n     */\r\n    open(stream) \r\n    {\r\n        const data = stream.split(\",\");\r\n        const callbackId = Number(data[0]);\r\n        const command = data[1];\r\n\r\n        /*\r\n            Since ExtendScript can't execute shell commands without blocking. \r\n            We're hijacking node.js exec() here.\r\n        */\r\n        this.childProcess = child_process.exec(command, \r\n        {\r\n            cwd: this.cwd,\r\n            timeout: 5 * 60 * 1000 // terminate long running processes\r\n        }, \r\n        (err, stdout, stderr) => \r\n        {\r\n            this.childProcess = null\r\n            let jsx = \"\";\r\n\r\n            if(err) {\r\n                console.error(err);\r\n                console.log(stderr);\r\n            } else {\r\n                stdout = stdout.replace(/\\\\/g, '\\\\\\\\').replace(/\\n/g, '\\\\n').replace(/\\r/g, '');\r\n                stderr = stderr.replace(/\\\\/g, '\\\\\\\\').replace(/\\n/g, '\\\\n').replace(/\\r/g, '');\r\n                jsx = `executeExecCallback(${callbackId},\"${stdout}\",\"${stderr}\");`;\r\n            }\r\n\r\n            this.emit(\"exit\", jsx);\r\n            this.close();\r\n        });\r\n\r\n        this.emit(\"enter\");\r\n    }\r\n    /**\r\n     * Sends a SIGTERM to the child process\r\n     */\r\n    close()\r\n    {\r\n        if(this.childProcess !== null && !this.childProcess.killed) \r\n            this.childProcess.kill();\r\n\r\n        this.removeAllListeners();\r\n    }\r\n}\r\n\r\n\r\n","import EventEmitter from \"events\";\r\n\r\n/**\r\n * @fires HostCallbackTunnelSetTimeout#enter immediately after setTimeout() is called\r\n * @fires HostCallbackTunnelSetTimeout#exit when setTimeout() callback is complete. this.close() is called immediately after this event.\r\n */\r\nexport default class HostCallbackTunnelSetTimeout extends EventEmitter\r\n{\r\n    constructor() \r\n    {\r\n        super();\r\n\r\n        this.timeoutId = 0;\r\n        this.tunnelId = 0;\r\n    }\r\n    get name() {\r\n        return \"setTimeout\";\r\n    }\r\n    getId() {\r\n        return this.tunnelId;\r\n    }\r\n    setId(id) {\r\n        this.tunnelId = id;\r\n    }\r\n    /**\r\n     * Execute the setTimeout() tunnel\r\n     * @param {string} stream the raw parameters string (e.g. \"<callback id>, 1000\")\r\n     */\r\n    open(stream) \r\n    {\r\n        const data = stream.split(\",\");\r\n        const callbackId = Number(data[0]);\r\n        const delay = Number(data[1]);\r\n\r\n        this.stream = stream;\r\n        this.timeoutId = setTimeout(() =>\r\n        {\r\n            this.timeoutId = 0;\r\n            this.emit(\"exit\", `executeSetTimeoutCallback(${callbackId})`);\r\n            this.close();\r\n        }, delay);\r\n\r\n        this.emit(\"enter\");\r\n    }\r\n    /**\r\n     * Force clears the setTimeout\r\n     */\r\n    close()\r\n    {\r\n        if(this.timeoutId)\r\n            clearTimeout(this.timeoutId);\r\n        \r\n        this.removeAllListeners();\r\n    }\r\n}","import EventEmitter from \"events\";\r\nimport upath from 'upath';\r\n\r\nimport HostCallbackTunnelExec from './hostCallbackTunnelExec';\r\nimport HostCallbackTunnelSetTimeout from './hostCallbackTunnelSetTimeout';\r\nimport appGlobal from '../global';\r\nimport store from '../store';\r\n\r\n\r\n/*\r\n    Creative Suite Extendscript Interface / Decorator\r\n*/\r\nclass Host extends EventEmitter\r\n{\r\n    constructor() \r\n    {\r\n        super();\r\n        /**\r\n         * To reduce coupling with GUI, this raw interface should not be used in Vue components\r\n         */\r\n        this.interface = new CSInterface();\r\n        this._initialized = false;\r\n        this._nextTunnelId = 0;\r\n        this._tunnelIdToTunnel = new Map();\r\n    }\r\n    /**\r\n     * @returns {Promise}\r\n     */\r\n    init() \r\n    {\r\n        if(this._initialized) return;\r\n        this._initialized = true;\r\n\r\n        // Host Environment Setup\r\n        this.importScript(\"utils.jsx\");\r\n        this.importScript(\"polyfil.jsx\");\r\n        this.importScript(\"console.jsx\");\r\n        this.importScript(\"json.jsx\"); \r\n        this.importScript(\"events.jsx\");\r\n        this.importScript(\"image.jsx\"); \r\n        \r\n        // Listeners\r\n        this.interface.addEventListener(\"log\", event => {\r\n            console.log(\"Jsx Log: \", event.data);\r\n        });\r\n        // Tunnel Listeners\r\n        this.interface.addEventListener(\"exec\", this._onExec.bind(this));\r\n        this.interface.addEventListener(\"setTimeout\", this._onSetTimeout.bind(this));\r\n\r\n        console.log(`Host initialized.\\n\r\n            Install Path: ${appGlobal.appInstallPath}\\n\r\n            Working Path: ${appGlobal.appWorkingPath}\\n\r\n            Default Log Path: ${appGlobal.appDefaultLogPath}\\n\r\n            Default Config Path: ${appGlobal.appDefaultConfigPath}\\n\r\n            Builtin Action Path: ${appGlobal.appBuiltinActionsPath}\\n\r\n            Creative Suite API Version: ${appGlobal.adobeCEPApiVersion}\\n\r\n            OS: ${appGlobal.os}\\n\r\n            App Version: ${appGlobal.appVersion}`);\r\n            \r\n        return Promise.resolve();\r\n    }\r\n    destroy()\r\n    {\r\n        for(const [id, tunnel] of this._tunnelIdToTunnel) {\r\n            tunnel.close();\r\n        }\r\n    }\r\n    /*---------------------\r\n            Events\r\n    ---------------------*/\r\n    dispatchEvent(eventName, data) \r\n    {\r\n        const scope = \"APPLICATION\";\r\n        const event = new CSEvent(eventName, scope);\r\n              event.data = data;\r\n        this.interface.dispatchEvent(event);\r\n    }\r\n    /**\r\n     * Returns a promise that is fulfilled when all jsx callbacks are completed (e.g. setTimeout() and exec())\r\n     * @returns {Promise}\r\n     */\r\n    join() {\r\n        if(this._nextTunnelId === 0) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return new Promise(resolve => \r\n        {\r\n            this.once(\"host.callback.join\", resolve);\r\n        });\r\n    }\r\n    _onSetTimeout(event)\r\n    {\r\n        const tunnel = new HostCallbackTunnelSetTimeout();\r\n        this._openTunnel(tunnel, event.data);\r\n    }\r\n    _onExec(event) \r\n    {\r\n        const tunnel = new HostCallbackTunnelExec(\r\n            store.general.pathToUserActions\r\n        );\r\n        this._openTunnel(tunnel, event.data);\r\n    }\r\n    _openTunnel(tunnel, stream) \r\n    {\r\n        const tunnelId = this._nextTunnelId++;\r\n        this._tunnelIdToTunnel.set(tunnelId, tunnel);\r\n\r\n        tunnel.setId(tunnelId);\r\n        tunnel.once(\"enter\", () => {\r\n            console.log(`Tunnel ${tunnel.getId()}: ${tunnel.name}\\n\\t ${stream}\\n\\t Entered.`);\r\n        });\r\n        tunnel.once(\"exit\", (jsx) => {\r\n            console.log(`Tunnel ${tunnel.getId()}: ${tunnel.name}\\n\\t ${stream}\\n\\t Exited.\\nWith Jsx:\\n\\t${jsx}`);\r\n            this._exitTunnel(tunnel, jsx);\r\n        });\r\n        tunnel.open(stream);\r\n    }\r\n    _exitTunnel(tunnel, jsx) \r\n    {\r\n        this._tunnelIdToTunnel.delete(tunnel.getId());\r\n\r\n        this.runJsxWithThrow(jsx)\r\n        .finally(() => \r\n        {\r\n            console.log(`Tunnel ${tunnel.getId()} Finished Executing Jsx Callback.`);\r\n\r\n            if(this._tunnelIdToTunnel.size === 0) {\r\n                this._nextTunnelId = 0;\r\n                this.emit(\"host.callback.join\");\r\n            }\r\n        });\r\n    }\r\n\r\n    /*---------------------\r\n        Extend Script\r\n    ---------------------*/\r\n    // NOTES:\r\n    // ActionReference is what to perform the action on within Photoshop  (e.g. document, marque tool, etc)\r\n    // The Action Manager system keeps track of a large number of Descriptors keys relative to the status of:\r\n    // - The Application\r\n    // - Documents\r\n    // - Layers\r\n    // - Channels\r\n    // - Paths\r\n    // - History\r\n    // - ActionSets and Actions \r\n\r\n    /**\r\n     * Import/Execute an ExtendScript file, such as a library.\r\n     * @param {string} fileName - name of file relative to app distribution path\r\n     */\r\n    async importScript(fileName) \r\n    {\r\n        const importPath = upath.join(appGlobal.appWorkingPath, fileName);\r\n        const result = await this.runJsx(`importJsx(\"${importPath}\");`);\r\n        console.log(\"Jsx File Imported: \" + importPath + \" Result: \" + result);\r\n    }\r\n    /**\r\n     * Evaluate ExtendScript/JSX script on Host\r\n     * @param {string} script \r\n     * @returns {Promise}\r\n     */\r\n    runJsx(script) \r\n    {\r\n        return new Promise(resolve => {\r\n            this.interface.evalScript(script, result => {\r\n                resolve(result);\r\n            })\r\n        });\r\n    }\r\n    /**\r\n     * Evaluate ExtendScript/JSX script on Host and throw an Exception if string \"error\" or \"exception\" is in the result.\r\n     * NOTE: If result is 'Evalscript error.' there may be a syntax error in the script string\r\n     * @param {string} script \r\n     * @returns {Promise}\r\n     */\r\n    runJsxWithThrow(script) \r\n    {\r\n        return new Promise((resolve, reject) => \r\n        {\r\n            this.interface.evalScript(`(function(){\r\n                try {\r\n                    ${script}\r\n                } catch(e) {\r\n                    return e.toString();\r\n                }\r\n            }())`, \r\n            (result) => {\r\n                const lowerCaseResult = result.toLowerCase();\r\n                if(lowerCaseResult.includes(\"error\") || lowerCaseResult.includes(\"exception\")) {\r\n                    reject(`\\nJsx:\\n${script}\\nException in Result:\\n${result}\\n`);\r\n                } else {\r\n                    resolve(result);\r\n                }\r\n            })\r\n        });\r\n    }\r\n    /**\r\n     * Run the ExtendScript action function by the given name\r\n     * @param {string} functionName \r\n     * @param {number|string|boolean|object|array} parameters \r\n     * @returns {Promise}\r\n     */\r\n    runActionWithParameters(functionName, parameters)\r\n    {\r\n        console.log(`Action: ${functionName}`);\r\n        const parametersJson = JSON.stringify(parameters);\r\n        return this.runJsxWithThrow(`\r\n            var result = ${functionName}(${parametersJson});\r\n            return result;\r\n        `);\r\n    }\r\n    \r\n    /**\r\n     * Converts an Action Manager charId to a stringId\r\n     * Returns empty string if error occurred.\r\n     * @param {string} charId \r\n     */\r\n    convertCharToStringId(charId) {\r\n        return this.runJsx(`t2s(c2t('${charId}'))`)\r\n        .then(result => {\r\n            return result.includes(\"error\") ? \"\" : result;\r\n        });\r\n    }\r\n    /**\r\n     * Converts an Action Manager stringId to a charId\r\n     * Returns empty string if error occurred.\r\n     * @param {string} charId \r\n     */\r\n    convertStringToCharId(stringId) {\r\n        return this.runJsx(`t2c(s2t('${stringId}'))`)\r\n        .then(result => {\r\n            return result.includes(\"error\") ? \"\" : result;\r\n        });\r\n    }\r\n}\r\n\r\nexport default new Host();","\"use strict\";\r\n\r\n\r\nfunction Enum(enumArr, offset) \r\n{\r\n    if(!(this instanceof Enum)) { return new Enum(enumArr, offset); }\r\n\r\n    return create_.call(this, enumArr, offset);\r\n}\r\n/** Essentially the enumeration starting value. Default is 0 */\r\nEnum.prototype.offset = 0;\r\n/** Return a copy of this.keys */\r\nEnum.prototype.toArray = function() {\r\n    return this.keys.slice(0);\r\n};\r\n/** Returns whether the given value is in the enumeration */\r\nEnum.prototype.isValid = function(val) {\r\n    return Number.isInteger(val) && (val - this.offset) < this.keys.length && (val - this.offset) >= 0;\r\n};\r\n/** Returns the key associated with the given value, else undefined. */\r\nEnum.prototype.toKey = function(val) {\r\n    if( !this.isValid(val) ) { return undefined; }\r\n    return this.keys[val - this.offset];\r\n};\r\n/** Returns the value associated with the given key, else undefined. */\r\nEnum.prototype.parse = function(key) {\r\n    if( !(typeof key === \"string\") ) { return undefined; }\r\n\r\n    key = key.trim().toUpperCase();\r\n    for(var i = 0; i < this.keys.length; ++i) {\r\n        if( this.keys[i].toUpperCase() === key ) { \r\n            return i + this.offset; \r\n        }\r\n    }\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * TODO: Needs Performance Improvement\r\n * @param {*} enumArr \r\n * @param {*} offset \r\n */\r\nfunction create_(enumArr, offset) \r\n{\r\n    if(!Array.isArray(enumArr)) {\r\n        throw new Error(\"Enum: create() Invalid parameter type. Expected Array.\");\r\n    }\r\n\r\n    var validName = /[A-Z_][A-Z0-9_]*/gi;\r\n\r\n    // Define array keys as properties\r\n    var enumer = this;\r\n        enumer.keys = [];\r\n        enumer.keys.length = enumArr.length;\r\n\r\n    if(Number.isInteger(offset)) {\r\n        enumer.offset = offset;\r\n    } else {\r\n        offset = 0;\r\n    }\r\n        \r\n    var nextKey;\r\n    for(var i = 0; i < enumArr.length; ++i) {\r\n        if( typeof enumArr[i] !== \"string\" || !validName.test(enumArr[i]) ) {\r\n            throw new Error(\"Enum: create() Not a string or Invalid name: \" + enumArr[i]);\r\n        }\r\n        validName.lastIndex = 0;\r\n        \r\n        nextKey = enumArr[i];\r\n        enumer.keys[i] = nextKey;\r\n        enumer[ nextKey ] = i + offset;       \r\n    }\r\n\r\n    // TODO: \r\n    // Object.defineProperty(this, 'enumValues', {\r\n    //     value: [],\r\n    //     configurable: false,\r\n    //     writable: false,\r\n    //     enumerable: true\r\n    // });\r\n    return enumer;\r\n}\r\n\r\nexport default Enum;\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{domProps:{\"innerHTML\":_vm._s(_vm.dots)}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <span v-html=\"dots\"></span>\r\n</template>\r\n\r\n<script>\r\nlet handle = 0;\r\n\r\nexport default {\r\n    name: \"WaitDots\", \r\n    props: {\r\n        intervalMs: {\r\n            type: Number,\r\n            default: 500\r\n        }\r\n    },\r\n    data() {\r\n        return { \r\n            dotCount: 1,\r\n            dots: \".\" \r\n        };\r\n    },\r\n    mounted() {\r\n        handle = setInterval(() => {\r\n            this.dots = \".\".repeat(this.dotCount);\r\n            this.dots += \"&nbsp;\".repeat(4 - this.dotCount);\r\n            this.dotCount = (this.dotCount + 1) % 4;\r\n        }, this.intervalMs);\r\n    },\r\n    beforeDestroy() {\r\n        clearInterval(handle);\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./wait-dots.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./wait-dots.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./wait-dots.vue?vue&type=template&id=6cb2c8b3&\"\nimport script from \"./wait-dots.vue?vue&type=script&lang=js&\"\nexport * from \"./wait-dots.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","module.exports = require(\"util\");","module.exports = require(\"os\");","module.exports = require(\"stream\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","\r\n\r\n/**\r\n * Represents a single Image process\r\n */\r\nexport default class Image \r\n{\r\n    constructor() \r\n    {\r\n        /**\r\n         * The path value that initiated this Image process.\r\n         * Depending on the File Source, this will be one of the following:\r\n         * 1) the absolute input file/directory path\r\n         * 2) the file/document name when full path is not available (e.g. an un-saved active document).\r\n         * 3) empty string (e.g. File Source is Blank)\r\n         */\r\n        this.initialInputImagePath = \"\";\r\n        /**\r\n         * Same as initialInputImagePath except when initialInputImagePath is a json data file\r\n         * in which case, this value is sourced from the json data.\r\n         * NOTE: an invalid/blank inputImagePath will cause an error when using a json input file\r\n         */\r\n        this.inputImagePath = \"\";\r\n        /**\r\n         * The parent directory of initialInputImagePath, or blank if not available \r\n         */\r\n        this.inputDirectory = \"\";\r\n        /**\r\n         * If available (either via json or GUI configuration), the directory where output files should be written\r\n         */\r\n        this.outputDirectory = \"\";\r\n        this.useOutputDirectory = false;\r\n        /**\r\n         * If available (either via json or GUI configuration), the directory where processed input files will be moved\r\n         */\r\n        this.processedDirectory = \"\";\r\n        this.useProcessedDirectory = false;\r\n        /**\r\n         * If available (either via json or GUI configuration), the directory where input files and error loges will be moved\r\n         */\r\n        this.errorDirectory = \"\";\r\n        this.useErrorDirectory = false;\r\n        /**\r\n         * External data (stored outside file) metadata necessary for processing, as sourced from JSON\r\n         */\r\n        this.data = {};     \r\n        /**\r\n         * Internal data (Metadata stored in the file)\r\n         */\r\n        this.metadata = {}; \r\n        /**\r\n         * (Optional) pipelines that should process this Image\r\n         */\r\n        this.pipelines = [];\r\n        /**\r\n         * The current pipeline processing this Image\r\n         */\r\n        this.pipeline = \"\";\r\n        /**\r\n         * The current job id for this Image (may be sourced from JSON) */\r\n        this.jobId = \"\";\r\n        /**\r\n         * An array of error messages encountered during processing, if applicable\r\n         * @type {Array<string>} \r\n         */\r\n        this.errors = [];\r\n    }\r\n}\r\n\r\n","import upath from 'upath';\r\nimport fs from 'fs';\r\nimport fsx from '../fsx';\r\nimport Image from './image';\r\n\r\nexport default class ImageFileMover \r\n{\r\n    constructor() {}\r\n\r\n    /**\r\n     * Moves the given Image instances and associated files to the given processed directory.\r\n     * Also writes any errors to the output directory\r\n     * @param {Array<Image>} images \r\n     */\r\n    async move(images) \r\n    {\r\n        console.log(`Moving ${images.length} processed images...`);\r\n        for(const image of images)\r\n        {\r\n            if(image.errors.length) {\r\n                const errorDirectory = image.errorDirectory || image.inputDirectory;\r\n                if(errorDirectory) {\r\n                    this._writeError(image, errorDirectory, image.errors.join('\\n'));\r\n                }\r\n                if(image.useErrorDirectory) {\r\n                    await this._moveImage(image, image.errorDirectory);\r\n                }\r\n            } else if(image.useProcessedDirectory) {\r\n                // TODO: Uncomment next line after Debugging\r\n                await this._moveImage(image, image.processedDirectory);\r\n            }\r\n        }\r\n        console.log(`Move completed.`);\r\n    }\r\n    /**\r\n     * @param {Image} image \r\n     * @param {string} toDirectory target directory. Absolute or relative to input or data source path.\r\n     */\r\n    async _moveImage(image, toDirectory)\r\n    {\r\n        if(!upath.isAbsolute(toDirectory)) \r\n        {\r\n            if(!image.inputDirectory) {\r\n                console.log(\"Image not moved. Move directory was relative but input directory was not defined.\");\r\n                return Promise.resolve();\r\n            } else {\r\n                toDirectory = upath.join(image.inputDirectory, toDirectory);\r\n            }\r\n        }\r\n\r\n        this._moveToDirectory(image, toDirectory);\r\n    }\r\n    _moveToDirectory(image, directory) \r\n    {\r\n        const paths = this._getImagePaths(image);\r\n        console.log(`Moving paths:\\n\\t${paths.join('\\n\\t')}\\nTo directory\\n\\t${directory}`);\r\n\r\n        for(const path of paths) \r\n        {\r\n            const basename = upath.basename(path);\r\n            const toPath = upath.join(directory, basename);\r\n            fsx.overwrite(path, toPath, err => {\r\n                if(err) {\r\n                    const message = err + \"\\nImage path could not be moved to \" + toPath;\r\n                    if(err.code == \"ENOENT\") {\r\n                        console.log(message);\r\n                    } else {\r\n                        console.warn(message);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n    _getImagePaths(image) \r\n    {\r\n        const paths = [\r\n            image.inputImagePath,\r\n            (image.initialInputImagePath !== image.inputImagePath) ? image.initialInputImagePath : null\r\n        ];\r\n        return paths.filter(p => !!p); // remove empty paths\r\n    }\r\n    _writeError(image, directory, message) \r\n    {\r\n        if(!message) {\r\n            return;\r\n        }\r\n        const logPath = upath.join(directory, \"error.logs\");\r\n        fs.writeFile(logPath, [   \r\n            `\\n`,\r\n            `Time: ${new Date().toLocaleString()}`,\r\n            `initialInputImagePath: ${image.initialInputImagePath}`, \r\n            `inputImagePath: ${image.inputImagePath}`, \r\n            message\r\n        ].join(`\\n`), \r\n        {\r\n            flag: 'a'\r\n        },\r\n        err => {\r\n            if(err) \r\n                console.error(err + \"\\nCould not write Image error to \" + logPath);\r\n        });\r\n    }\r\n}","import upath from 'upath';\r\n\r\n/**\r\n * Returns true if path starts with // or \\\\ \r\n * @param {string} val the path string\r\n */\r\nfunction isUncPath(val) \r\n{\r\n    val = val.trim();\r\n    return val.startsWith(\"//\") || val.startsWith(\"\\\\\\\\\");\r\n}\r\n\r\n/**\r\n * Normalizes and compares the two paths to determine \r\n * if the given child is a child path of the given ancestor\r\n * @param {string} descendant \r\n * @param {string} ancestor \r\n */\r\nfunction isAncestor(ancestor, descendant)\r\n{\r\n    const relative = upath.relative(ancestor, descendant);\r\n    // If not ancestor, beginning of path will contain directory traversal (e.g. ../../)\r\n    return descendant.endsWith(relative);\r\n}\r\n\r\n/**\r\n * Same as upath.dirname except ensures that double slash is maintained for UNC paths\r\n * @param {string} val the path string\r\n */\r\nfunction dirname(val)\r\n{\r\n    return _preserveUnc(val, upath.dirname(val));\r\n}\r\n/**\r\n * Same as upath.normalize except ensures that double slash is maintained for UNC paths\r\n * @param {string} val the path string\r\n */\r\nfunction normalize(val)\r\n{\r\n    return _preserveUnc(val, upath.normalize(val));\r\n}\r\n/**\r\n * Same as upath.join except ensures that double slash is maintained for UNC paths\r\n * @param {string} val the path string\r\n */\r\nfunction join(firstPart)\r\n{\r\n    return _preserveUnc.call(null, firstPart, upath.join.apply(upath, arguments));\r\n}\r\n\r\nfunction _preserveUnc(originalPath, newPath) \r\n{\r\n    if(isUncPath(originalPath)) {\r\n        return newPath.charAt(0) + newPath;\r\n    } \r\n    return newPath;\r\n}\r\n\r\nexport default {\r\n    isAncestor,\r\n    isUncPath,\r\n    dirname,\r\n    normalize, \r\n    join\r\n}","import exiftool from 'node-exiftool';\r\nimport upath from 'upath';\r\nimport fs from 'fs';\r\nimport Image from './image';\r\nimport fsx from '../fsx';\r\nimport uncSafePath from '../unc-safe-path';\r\nimport _ from '../utils';\r\n\r\n\r\n\r\nexport default class ImageFileReader\r\n{\r\n    /**\r\n     * Create a reader used to generate an Image instance for processing by Adobe host\r\n     */\r\n    constructor() {} \r\n\r\n    /**\r\n     * Create a new Image instance for processing by Adobe host\r\n     * NOTE: When 'path' is a json file, directories will be automatically created for output, processed, and error directories\r\n     * @param {String} path the image path, json file path, document name (e.g. when using Active Document), or empty string. Path should be absolute\r\n     * @param {ImageSource} imageSource the image source that produced the path \r\n     * @param {Array<string>} targetPipelines\r\n     */\r\n    async read(path, imageSource, targetPipelines)\r\n    {\r\n        let { useOutputDirectory, useProcessedDirectory, useErrorDirectory } = imageSource;\r\n        let { outputDirectory, processedDirectory, errorDirectory } = imageSource;\r\n        let readMetadata = imageSource.readMetadata;\r\n\r\n        // Sanity check\r\n        outputDirectory = useOutputDirectory ? outputDirectory : \"\";\r\n        processedDirectory = useProcessedDirectory ? processedDirectory : \"\";\r\n        errorDirectory = useErrorDirectory ? errorDirectory : \"\";\r\n\r\n        let initialInputImagePath = path || \"\";\r\n        let inputImagePath = initialInputImagePath;\r\n        let inputDirectory = this._isPathDefinedAndAbsolute(path) ? uncSafePath.dirname(path) : \"\";\r\n        let pipelines = targetPipelines;\r\n        let jobId = _.guid();\r\n        let data = {};\r\n        let metadata = {};\r\n        let image = new Image();\r\n\r\n        try \r\n        {\r\n            if(this._doesFileExist(inputImagePath)) \r\n            {\r\n                if(this._doesPathHaveJsonExtension(inputImagePath)) \r\n                {\r\n                    data = await this._readJson(inputImagePath);\r\n                    pipelines = data.pipelines || pipelines;\r\n                    pipelines = (typeof pipelines === \"string\") ? pipelines.split(',') : pipelines;\r\n                    readMetadata = (typeof data.readMetadata === \"boolean\") ? data.readMetadata : readMetadata;\r\n                    jobId = data.jobId || jobId;\r\n\r\n                    // Grab new image source path and other paths from json, if available\r\n                    inputImagePath = data.inputImagePath || \"\";\r\n                    outputDirectory = data.outputDirectory || outputDirectory;\r\n                    processedDirectory = data.processedDirectory || processedDirectory;\r\n                    errorDirectory = data.errorDirectory || errorDirectory;\r\n\r\n                    inputImagePath = this._ensureAbsolutePath(inputImagePath, inputDirectory);\r\n                    outputDirectory = this._ensureAbsolutePath(outputDirectory, inputDirectory);\r\n                    processedDirectory = this._ensureAbsolutePath(processedDirectory, inputDirectory);\r\n                    errorDirectory = this._ensureAbsolutePath(errorDirectory, inputDirectory);\r\n\r\n                    useOutputDirectory = await this._makeDirectory(outputDirectory);\r\n                    useProcessedDirectory = await this._makeDirectory(processedDirectory);\r\n                    useErrorDirectory = await this._makeDirectory(errorDirectory);\r\n\r\n                    // Blank paths if directory doesn't exist\r\n                    outputDirectory = useOutputDirectory ? outputDirectory : \"\";\r\n                    processedDirectory = useProcessedDirectory ? processedDirectory : \"\";\r\n                    errorDirectory = useErrorDirectory ? errorDirectory : \"\";\r\n\r\n                    if (uncSafePath.isAncestor(inputImagePath, inputDirectory) \r\n                        && (useProcessedDirectory || useErrorDirectory)) \r\n                    {\r\n                        // Otherwise ImageFileMover would attempt to move the root/source directory\r\n                        // This rule should probably be thrown inside of ImageFileMover\r\n                        throw new Error(`JSON inputImagePath cannot be ancestor directory of or same as input directory when using errorDirectory or processedDirectory options.`);\r\n                    }\r\n                }\r\n                if(this._doesFileExist(inputImagePath) && readMetadata === true) \r\n                {\r\n                    metadata = await this._readMetadata(inputImagePath);\r\n                }\r\n            }\r\n        }\r\n        catch(e) \r\n        {\r\n            image.errors.push(e.toString());\r\n        }\r\n        finally \r\n        {\r\n            image.jobId = jobId;\r\n            image.initialInputImagePath = initialInputImagePath;\r\n            image.inputImagePath = inputImagePath;        \r\n            image.inputDirectory = inputDirectory;\r\n            image.outputDirectory = outputDirectory;\r\n            image.processedDirectory = processedDirectory;\r\n            image.errorDirectory = errorDirectory;\r\n            image.useOutputDirectory = useOutputDirectory;\r\n            image.useProcessedDirectory = useProcessedDirectory;\r\n            image.useErrorDirectory = useErrorDirectory;\r\n            image.data = data;\r\n            image.metadata = metadata;\r\n            image.pipelines = pipelines;\r\n\r\n            return image;\r\n        }\r\n    }\r\n    /**\r\n     * Reads any json from the given data source, if it is json and it exists.\r\n     * @returns {object}\r\n     */\r\n    async _readJson(jsonFilePath)\r\n    {\r\n        return new Promise((resolve, reject) => {\r\n            fs.readFile(jsonFilePath, { encoding: 'utf8' }, (error, jsonString) => {\r\n                if(error) {\r\n                    reject(`Image json ${jsonFilePath} file could not be read.\\n${error}`);\r\n                    return;\r\n                }\r\n                try {\r\n                    const data = JSON.parse(jsonString);\r\n                    resolve(data);\r\n                } catch(e) {\r\n                    reject(e);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * Reads any metadata from the given source, if it is a file\r\n     * @returns {object}\r\n     */\r\n    async _readMetadata(inputImagePath)\r\n    {\r\n        let ep = new exiftool.ExiftoolProcess();\r\n        let processid = 0;\r\n\r\n        return ep.open()\r\n        .then(pid => {\r\n            processid = pid;\r\n        })\r\n        .then(() => ep.readMetadata(inputImagePath, ['-File:all']))\r\n        .then(metadata => {\r\n            let fileMetadata = metadata.data[0];\r\n            return fileMetadata;\r\n        })\r\n        .finally(() => {\r\n            ep.close();\r\n        });\r\n    }\r\n    _isPathDefinedAndAbsolute(path) {\r\n        return typeof path === \"string\" && path.length > 0 && upath.isAbsolute(path);\r\n    }\r\n    _ensureAbsolutePath(path, parentDirectory) {\r\n        if(!path) {\r\n            return \"\";\r\n        }\r\n        return upath.isAbsolute(path) ? path : upath.join(parentDirectory, path);\r\n    }\r\n    _doesPathHaveJsonExtension(path) {\r\n        return upath.extname(path) === \".json\";\r\n    }\r\n    _doesFileExist(path) {\r\n        try {\r\n            return fs.lstatSync(path || \"\").isFile();\r\n        } catch(e) {\r\n            if(e && e.code == \"ENOENT\") {\r\n                return false;\r\n            } else {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n    _doesDirectoryExist(path) {\r\n        try {\r\n            return fs.lstatSync(path || \"\").isDirectory();\r\n        } catch(e) {\r\n            if(e && e.code == \"ENOENT\") {\r\n                return false;\r\n            } else {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n    _makeDirectory(directory) \r\n    {\r\n        return new Promise((resolve, reject) => {\r\n            if(!directory) {\r\n                resolve(false);\r\n                return;\r\n            }\r\n            fsx.mkdir(directory, { recursive: true }, err => {\r\n                if(err && err.code !== \"ENOENT\") {\r\n                    reject(`${err}\\nCould not create directory.`);\r\n                } else {\r\n                    resolve(true);\r\n                }\r\n            });\r\n        });\r\n    }\r\n}","import fs from 'fs';\r\nimport chokidar from 'chokidar';\r\nimport upath from 'upath';\r\nimport isUncPath from 'is-unc-path';\r\nimport EventEmitter from \"events\";\r\nimport ImageSource from './imageSource';\r\nimport ImageSourceType from './imageSourceType';\r\nimport host from '../host';\r\nimport _, { EDebounceType } from '../utils';\r\n\r\n\r\nlet nextProducerId = 0;\r\n/**\r\n * Reads images from source described by ImageSource and produces file paths for consumption\r\n * A producer has a single source.\r\n * A producer will not automatically deplete when sourcing from a File Watcher\r\n * IMPORTANT: Multiple producers should not be created for the same set of files\r\n */\r\nexport default class ImageFileProducer extends EventEmitter\r\n{\r\n    constructor(imageSource) \r\n    {\r\n        super();\r\n        this._id = nextProducerId++;\r\n        this._imageSource = imageSource;\r\n        this._fileWatcher = null;\r\n        this._isDepleted = false;\r\n\r\n        // NOTE: We debounce in order to collect files from file watcher and emit them \r\n        // in one lump. This helps avoid issues where shared files are moved at the end\r\n        // of an IMAGE process pre-maturely, when the next process also needs them.\r\n        // This isn't the best solution, since it is a completely blind process.\r\n        // A better option would be to submit explicit files for processing as one 'job',\r\n        // via a REST api or similar interface.\r\n        this._q = [];\r\n        this._emitQFiles = _.debounce(this._emitQFiles, 5000, EDebounceType.Trailing);\r\n    }\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    produce()\r\n    {\r\n        // TODO: Split source types into their own implementation of a producer interface?\r\n        switch(this._imageSource.sourceType) \r\n        {\r\n            case ImageSourceType.FILEWATCHER: this._sourceFileWatchers(); break;\r\n            case ImageSourceType.DIRECTORY: this._sourceDirectory(); break;\r\n            case ImageSourceType.OPENFILES: this._sourceOpenFiles(); break;\r\n            case ImageSourceType.BLANK: this._sourceBlank(); break;\r\n            case ImageSourceType.ACTIVEDOCUMENT: this._sourceActiveDocument(); break;\r\n            default: throw new Error(\"Unknown ImageSourceType: \" + this._imageSource.sourceType);\r\n        }\r\n    }\r\n    destroy()\r\n    {\r\n        // ASSERT: Should NOT emit any more files from this point\r\n        if(this._fileWatcher) {\r\n            this._fileWatcher.removeAllListeners();\r\n            this._fileWatcher.close();\r\n        }\r\n        this.removeAllListeners();\r\n    }\r\n    getImageSource()\r\n    {\r\n        return this._imageSource;\r\n    }\r\n    toString() {\r\n        return `\\tid = ${this._id}\\n\\timageSource = (${this._imageSource.toString()})`;\r\n    }\r\n    _emitFiles(files) \r\n    {\r\n        if(!files.length > 0) {\r\n            return;\r\n        }\r\n        this.emit(\"files\", this._id, files);\r\n    }\r\n    _emitQFiles()\r\n    {\r\n        const files = this._q;\r\n        this._q = [];\r\n        this._emitFiles(files);\r\n    }\r\n    _sourceFileWatchers() \r\n    {\r\n        const watchPathRoot = this._imageSource.sourceDirectory;\r\n        const watchExtensions = this._imageSource.sourceExtensions;\r\n        const watchPaths = watchExtensions.map(ext => upath.join(watchPathRoot, \"*.\" + ext));\r\n\r\n        if(isUncPath(watchPathRoot)) {\r\n            throw Error(`Watching network paths is problematic. Only local directories supported at this time.`);\r\n        }\r\n        if(!fs.existsSync(watchPathRoot)) {\r\n            throw Error(`Watch path: ${watchPathRoot} does not exist.`);\r\n        }\r\n        const watcher = chokidar.watch(watchPaths, {\r\n            ignored: /^\\./, \r\n            depth: 0,\r\n            usePolling: true,\r\n            interval: 5000,\r\n            awaitWriteFinish: {\r\n                stabilityThreshold: 5000,\r\n                pollInterval: 5000\r\n            }\r\n        })\r\n        .on(\"add\", newPath => \r\n        {\r\n            if(upath.basename(newPath).startsWith(\"manifest\")) {\r\n                return;\r\n            }\r\n            this._q.push(newPath);\r\n            this._emitQFiles();\r\n        });\r\n\r\n        this._fileWatcher = watcher;\r\n    }\r\n    /**\r\n     * Reads source directory for files and filters by extensions\r\n     */\r\n    _sourceDirectory() \r\n    {\r\n        const directory = this._imageSource.sourceDirectory;\r\n        const extensions = this._imageSource.sourceExtensions;\r\n\r\n        fs.readdir(directory, { encoding: \"utf8\" }, (error, files) => {\r\n            if(error) {\r\n                this.emit(\"depleted\", this._id);\r\n                throw new Error(error);\r\n            }\r\n            if(files) \r\n            {\r\n                files = files.map(file => upath.join(directory, file));\r\n                files = files.filter(file => {\r\n                    if(upath.basename(file).startsWith(\"manifest\")) {\r\n                        return false;\r\n                    }\r\n                    const ext = file.split('.').pop();\r\n                    return extensions.includes(ext);\r\n                });\r\n                this._isDepleted = true;\r\n                this._emitFiles(files);\r\n            }\r\n            this.emit(\"depleted\", this._id);\r\n        });\r\n    }\r\n    /**\r\n     * Asks Adobe application for currently open documents \r\n     */\r\n    _sourceOpenFiles() \r\n    {\r\n        host.runActionWithParameters(\"action.getOpenDocumentPaths\")\r\n        .then(filePaths => {\r\n            this._isDepleted = true;\r\n            this._emitFiles(filePaths.split(','));\r\n            this.emit(\"depleted\", this._id);\r\n        });\r\n    }\r\n    _sourceBlank()\r\n    {\r\n        this._isDepleted = true;\r\n        this._emitFiles([\"\"]);\r\n        this.emit(\"depleted\", this._id);\r\n    }\r\n    _sourceActiveDocument()\r\n    {\r\n        host.runActionWithParameters(\"action.getActiveDocumentPath\")\r\n        .then(filePath => {\r\n            this._isDepleted = true;\r\n            this._emitFiles(filePath ? [filePath] : []);\r\n            this.emit(\"depleted\", this._id);\r\n        });\r\n    }\r\n}","import EventEmitter from \"events\";\r\nimport ImageFileProducer from './imageFileProducer';\r\nimport _ from '../utils';\r\n\r\n/**\r\n * Manages ImageFileProducer instances and produces image jobs\r\n */\r\nexport default class ImageFileProducers extends EventEmitter\r\n{\r\n    constructor() \r\n    {\r\n        super();\r\n        /**\r\n         * Producer Id => [Listener Names...]\r\n         */\r\n        this._producerIdToListenerNames = new Map();\r\n        /**\r\n         * Producer Id => ImageFileProducer instance\r\n         */\r\n        this._producerIdToProducer = new Map();\r\n\r\n        this._jobs = [];\r\n    }\r\n    destroy()\r\n    {\r\n        this.stopProducers();\r\n        this.removeAllListeners();\r\n    }\r\n    /**\r\n     * Create and start a producer with the given ImageSource\r\n     * @param {ImageSource} imageSource \r\n     * @param {Array<string>} listenerNames \r\n     */\r\n    startProducer(imageSource, listenerNames) \r\n    {\r\n        const producer = new ImageFileProducer(imageSource);\r\n        console.log(`Image File Producer created:\\n${producer.toString()}`);\r\n\r\n        this._producerIdToListenerNames.set(producer.id, listenerNames);\r\n        this._producerIdToProducer.set(producer.id, producer);\r\n\r\n        producer.on(\"files\", this._onProducerFiles.bind(this));\r\n        producer.on(\"depleted\", this._onProducerDepleted.bind(this));\r\n        producer.produce();\r\n    }\r\n    /**\r\n     * Stops all ImageFileProducer instances and clears the job queue\r\n     */\r\n    stopProducers() {\r\n        const producerIds = [...this._producerIdToProducer.keys()];\r\n        this._stopProducers(producerIds);\r\n        this._jobs = [];\r\n    }\r\n    hasProducers() {\r\n        return this._producerIdToProducer.size > 0;\r\n    }\r\n    hasJobs() {\r\n        return this._jobs.length > 0;\r\n    }\r\n    nextJob() {\r\n        return this._jobs.pop();\r\n    }\r\n    /**\r\n     * @readonly\r\n     */\r\n    getAllJobs() {\r\n        return this._jobs; // TODO: Clone?\r\n    }\r\n    getTotalJobs() {\r\n        return this._jobs.length;\r\n    }\r\n    _stopProducers(producerIds)\r\n    {\r\n        producerIds = producerIds.filter(id => this._producerIdToProducer.has(id));\r\n        for(const producerId of producerIds) \r\n        {\r\n            const producer = this._producerIdToProducer.get(producerId);\r\n            console.log(`Image File Producer destroyed:\\n${producer.toString()}`);\r\n\r\n            this._producerIdToProducer.delete(producerId);\r\n            this._producerIdToListenerNames.delete(producerId);\r\n            producer.destroy();\r\n        }\r\n    }\r\n    _onProducerFiles(producerId, files)\r\n    {\r\n        const listenerNames = this._producerIdToListenerNames.get(producerId);\r\n        const imageSource = this._producerIdToProducer.get(producerId).getImageSource();\r\n        this._jobs.push({\r\n            jobId: _.guid(), \r\n            jobCreationTime: _.yyyymmddhhmmss(),\r\n            listenerNames: listenerNames.slice(0),\r\n            files, \r\n            imageSource: imageSource.clone()\r\n        });\r\n        this.emit(\"job\");\r\n        console.log(`Image File Producer ${producerId}: Job produced.`);\r\n    }\r\n    _onProducerDepleted(producerId) \r\n    {\r\n        this._stopProducers([producerId]);\r\n        this.emit(\"depleted\");\r\n    }\r\n}","\r\nexport default class PipelineEngineStatus\r\n{\r\n    constructor() \r\n    {\r\n        this.reset();\r\n        Object.seal(this);\r\n    }\r\n    reset() {\r\n        this.jobId = \"\";\r\n        this.jobCreationTime = \"\";\r\n        this.files = [];\r\n        this.fileCount = 0;\r\n        this.file = \"\";\r\n        this.imageJobId = \"\";\r\n        this.imageIteration = 0;\r\n        this.pipeline = \"\";\r\n        this.action = \"\";\r\n    }\r\n    serialize() {\r\n        return {\r\n            ...this\r\n        }\r\n    }\r\n}","import EventEmitter from \"events\";\r\nimport Rete from \"rete\"; \r\n\r\nimport _ from '../utils';\r\nimport store from '../store';\r\nimport host from '../host';\r\nimport Image from './image';\r\nimport ImageFileMover from './imageFileMover';\r\nimport ImageFileReader from './imageFileReader';\r\nimport ImageFileProducers from './imageFileProducers';\r\nimport PipelineEngineState from './pipelineEngineState';\r\nimport PipelineEngineStatus from './pipelineEngineStatus';\r\n\r\nexport class PipelineEngine extends EventEmitter\r\n{\r\n    constructor() \r\n    {\r\n        super();\r\n        const self = this;\r\n        this._processingMutex = false; \r\n        this._lastState = PipelineEngineState.STOPPED;\r\n        this._state = PipelineEngineState.STOPPED;\r\n        this._status = new Proxy(new PipelineEngineStatus(), \r\n            {\r\n                set: function() { \r\n                    Reflect.set(...arguments);\r\n                    self.emit(\"status\", self._status);\r\n                    return true;\r\n                }\r\n            }\r\n        );\r\n        this.on(\"jobstart\", (jobId, jobCreationTime, files) => {\r\n            this._status.jobId = jobId;\r\n            this._status.jobCreationTime = jobCreationTime;\r\n            this._status.files = files;\r\n            this._status.fileCount = files.length;\r\n        });\r\n        this.on(\"imagejobstart\", (imageJobId, imageIteration, file) => {\r\n            this._status.imageJobId = imageJobId;\r\n            this._status.imageIteration = imageIteration;\r\n            this._status.file = file;\r\n        });\r\n        this.on(\"pipelinestart\", pipelineName => { \r\n            this._status.pipeline = pipelineName; \r\n        });\r\n        this.on(\"pipelineend\", () => { \r\n            this._status.pipeline = \"\"; \r\n        });\r\n        this.on(\"actionstart\", actionName => { \r\n            this._status.action = actionName; \r\n        });\r\n        this.on(\"actionend\", () => { \r\n            this._status.action = \"\"; \r\n        });\r\n        this.on(\"jobend\", () => this._status.reset());\r\n        this.on(\"processstart\", () => this._status.reset());\r\n        this.on(\"processend\", () => this._status.reset());\r\n        \r\n        this._imageFileReader = new ImageFileReader();\r\n        this._imageFileMover = new ImageFileMover();\r\n        this._imageFileProducers = new ImageFileProducers();\r\n        this._imageFileProducers.on(\"job\", this._onProducerJob.bind(this));\r\n        this._imageFileProducers.on(\"depleted\", this._onProducerDepleted.bind(this));\r\n    }\r\n    /**\r\n     * @returns {Promise}\r\n     */\r\n    init() \r\n    {\r\n        return Promise.resolve();\r\n    }\r\n    destroy()\r\n    {\r\n        this._imageFileProducers.destroy();\r\n        this.state = PipelineEngineState.STOPPED;\r\n    }\r\n    /**\r\n     * Run the given pipeline using its configured file source(s)\r\n     * @param {string} pipelineName pipeline name\r\n     */\r\n    run(pipelineName)\r\n    {\r\n        this._run([pipelineName]);\r\n    }\r\n    /**\r\n     * Run all pipelines using their configured file source(s)\r\n     */\r\n    runAll()\r\n    {\r\n        const pipelineNames = store.pipelines.pipelines.map(p => p.name);\r\n        this._run(pipelineNames);\r\n    }\r\n    _run(pipelineNames) \r\n    {\r\n        if(!this.isStopped()) {\r\n            console.log(\"Pipeline engine is already running.\");\r\n            return;\r\n        }\r\n        console.log(`Running pipelines: \"${pipelineNames.join(\",\")}\"`);\r\n        this.state = PipelineEngineState.IDLE;\r\n\r\n        // IMPORTANT: We Do Not want multiple producers for the same files\r\n        // Which would happen if we looped by each pipeline and created its producers\r\n        // since there is a many-to-one relationship between pipelines and file watchers\r\n        const imageSourceNameToPipelineNames = store.pipelines.getImageSourceNameToPipelineNameMap(pipelineNames);\r\n        for(let [imageSourceName, toPipelineNames] of imageSourceNameToPipelineNames.map) \r\n        {\r\n            const imageSource = store.general.getImageSourceByName(imageSourceName);         \r\n            this._imageFileProducers.startProducer(imageSource, toPipelineNames);\r\n        }\r\n    }\r\n    pause() {\r\n        if(this.isProcessing() || this.isIdle()) {\r\n            this.state = PipelineEngineState.PAUSED;\r\n        }\r\n    }\r\n    resume() {\r\n        if(this.isPaused() && this._lastState === PipelineEngineState.PROCESSING) {\r\n            this.state = PipelineEngineState.PROCESSING;\r\n        } else {\r\n            this.state = PipelineEngineState.IDLE;\r\n        }\r\n    }\r\n    stop() {\r\n        this._imageFileProducers.stopProducers();\r\n        this.state = PipelineEngineState.STOPPED;\r\n    }\r\n    _stopIfNoProducersElseIdle()\r\n    {\r\n        if(this.isStopped()) {\r\n            return;\r\n        }\r\n        if(!this._imageFileProducers.hasProducers()) {\r\n            this.stop();\r\n        } else {\r\n            this.state = PipelineEngineState.IDLE;\r\n        }\r\n    }\r\n    \r\n\r\n    _onProducerJob() \r\n    {\r\n        this._process();\r\n    }\r\n    _onProducerDepleted() {\r\n        if(this.isProcessing()) return;\r\n        this._stopIfNoProducersElseIdle();\r\n    }\r\n    _process()\r\n    {\r\n        if(!this._imageFileProducers.hasJobs()) return; \r\n        if(this._processingMutex) return;\r\n        this._processingMutex = true;\r\n        this.state = PipelineEngineState.PROCESSING;\r\n\r\n        this._runWaitOneFrame()\r\n        .then(this._runProcessStart.bind(this))\r\n        .then(this._runProcessLoop.bind(this))\r\n        .then(this._runProcessEnd.bind(this))\r\n        .then(() => {\r\n            this._stopIfNoProducersElseIdle();\r\n            this._processingMutex = false;\r\n        });\r\n    }\r\n    _runWaitOneFrame()\r\n    {\r\n        return new Promise(resolve => { setTimeout(resolve, 0); });\r\n    }\r\n    async _runProcessStart()\r\n    {\r\n        await this._pauseCheck();\r\n\r\n        console.log(`Pipeline process loop started with ${this._imageFileProducers.getTotalJobs()} jobs in queue.`);\r\n        this.emit(\"processstart\");\r\n        await host.runJsxWithThrow(`app.displayDialogs = DialogModes.NO;`);\r\n    }\r\n    async _runProcessLoop()\r\n    {\r\n        let processedImages = [];\r\n        let file;\r\n        while(!this._stopCheck() && this._imageFileProducers.hasJobs()) \r\n        {\r\n            const { \r\n                jobId, \r\n                jobCreationTime,\r\n                listenerNames, \r\n                files, \r\n                imageSource } = this._imageFileProducers.nextJob();\r\n            this.emit(\"jobstart\", jobId, jobCreationTime, files.slice(0));\r\n            console.log(`Job ${jobId} started with ${files.length} files.`);\r\n\r\n            for(let i = 0; !this._stopCheck() && i < files.length; ++i)\r\n            {\r\n                await this._pauseCheck();\r\n                const file = files[i];\r\n\r\n                // READ IMAGE\r\n                console.log(`Reading next file[${i}] ${file}.`);\r\n                const image = await this._imageFileReader.read(file, imageSource, listenerNames);\r\n\r\n                // EXECUTE PIPELINES\r\n                if(!image.errors.length > 0) \r\n                {\r\n                    this.emit(\"imagejobstart\", image.jobId, i, file);\r\n                    await this._runPipelinesLoop(image);\r\n                    this.emit(\"imagejobend\");\r\n                }\r\n\r\n                processedImages.push(image);\r\n                await this._pauseCheck(null, store.general.pauseAfterEveryImage);\r\n            }\r\n            this.emit(\"jobend\");\r\n        }\r\n        \r\n        return processedImages;\r\n    }\r\n    async _runProcessEnd(processedImages)\r\n    {\r\n        console.log(\"Waiting for unresolved callback tunnels...\");\r\n        await host.join();\r\n\r\n        // CLEANUP\r\n        if(this._stopCheck()) {\r\n            host.runActionWithParameters(`action.closeAllWithoutSave`);\r\n        } else {\r\n            // We move at the end of the process, in case images/jobs are sharing files\r\n            this._imageFileMover.move(processedImages);\r\n        }\r\n\r\n        console.log(\"Pipeline process exited.\");\r\n        this.emit(\"processend\");\r\n        await host.runJsxWithThrow(`$.gc();`);\r\n    }\r\n    /**\r\n     * Execute pipeline action graph for this image\r\n     * @param {Image} image \r\n     */\r\n    async _runPipelinesLoop(image)\r\n    {\r\n        const pipelines = store.pipelines.getByNames(image.pipelines);\r\n        for(const pipeline of pipelines) \r\n        {\r\n            try \r\n            {\r\n                await this._runPipelineStart(image, pipeline);\r\n\r\n                // EXECUTE PIPELINE\r\n                for(const action of pipeline.actions) \r\n                {\r\n                    this.emit(\"actionstart\", action.actionName);\r\n                    let result = await host.runActionWithParameters(action.actionName, action.parameters);\r\n                    \r\n                    if(this._stopCheck(result)) break;\r\n                    await this._pauseCheck(result, store.general.pauseAfterEveryAction);\r\n                    this.emit(\"actionend\");\r\n                }\r\n            }\r\n            catch(e)\r\n            {\r\n                console.error(e);\r\n                image.errors.push(e.toString());\r\n                await host.runActionWithParameters(`action.closeAllWithoutSave`);\r\n                await this._pauseCheck(null, store.general.pauseOnExceptions);\r\n            }\r\n            finally\r\n            {\r\n                if(image.errors.length) break;\r\n                if(this._stopCheck()) break;\r\n                await this._pauseCheck(null, store.general.pauseAfterEveryPipeline);\r\n                await this._runPipelineEnd(image, pipeline);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Close all documents. Save Photoshop settings. Instantiate IMAGE instance.\r\n     * @param {Image} image \r\n     * @param {object} pipeline the pipeline configuration object\r\n     * @returns {Promise}\r\n     */\r\n    _runPipelineStart(image, pipeline)\r\n    {\r\n        console.log(`Pipeline '${pipeline.name}' started for image job ${image.jobId}.`);\r\n        this.emit(\"pipelinestart\", pipeline.name);\r\n        return host.runJsxWithThrow(`\r\n        __PIPELINE = {\r\n            name: \"${pipeline.name}\",\r\n            restoreUnits: _.saveUnits()\r\n        };\r\n        IMAGE = new ImageForProcessing(${JSON.stringify(image)});`);\r\n    }\r\n    /**\r\n     * Restore Photoshop settings. Clear IMAGE instance.\r\n     * @param {object} pipeline the pipeline configuration object \r\n     * @returns {Promise}\r\n     */\r\n    _runPipelineEnd(image, pipeline)\r\n    {\r\n        console.log(`Pipeline '${pipeline.name}' ended for image job ${image.jobId}.`);\r\n        this.emit(\"pipelineend\");\r\n        return host.runJsx(`\r\n        __PIPELINE.restoreUnits && __PIPELINE.restoreUnits(); \r\n        __PIPELINE=null;\r\n        IMAGE=null;\r\n        `);\r\n    }\r\n    _stopCheck(actionResult) \r\n    {\r\n        if(this.isStopped() || actionResult === \"STOP\") {\r\n            this.state = PipelineEngineState.STOPPED;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    _pauseCheck(actionResult, forcePause) \r\n    {\r\n        if(this.isPaused() || forcePause || actionResult === \"PAUSE\") \r\n        {\r\n            console.log(\"Pipeline Engine waiting on pause...\");\r\n            this.state = PipelineEngineState.PAUSED;\r\n\r\n            return new Promise(resolve => {\r\n                this.once(\"state\", state => {\r\n                    if(state != PipelineEngineState.PAUSED) {\r\n                        resolve();\r\n                    }\r\n                });\r\n            });\r\n        } \r\n        return Promise.resolve();\r\n    }\r\n    \r\n    get fullStatus() \r\n    {\r\n        return {\r\n            state: PipelineEngineState.toKey(this._state),\r\n            jobs: this._imageFileProducers.getAllJobs(),\r\n            status: this._status.serialize()\r\n        };\r\n    }\r\n    get status() {\r\n        return this._status.serialize();\r\n    }\r\n    get state() {\r\n        return this._state;\r\n    }\r\n    set state(value) {\r\n        this._lastState = this._state;\r\n        this._state = value;\r\n        this.emit(\"state\", value);\r\n    }\r\n    isIdle() { return this.state === PipelineEngineState.IDLE; }\r\n    isStopped() { return this.state === PipelineEngineState.STOPPED; }\r\n    isPaused() { return this.state === PipelineEngineState.PAUSED; }\r\n    isProcessing() { return this.state === PipelineEngineState.PROCESSING; }\r\n}","import upath from 'upath';\r\nimport fs from 'fs';\r\nimport EventEmitter from \"events\";\r\nconst jsdoc = require(\"jsdoc-api\");\r\n//import jsdocx from 'jsdoc-x';\r\n\r\nimport store from '../store';\r\nimport host from '../host';\r\nimport global from '../global';\r\nimport FolderTreeNode from '../folderTree';\r\nimport { resolve } from 'path';\r\n\r\nconst ROOT_ACTION_DIRECTORY = \"actions\";\r\nconst ROOT_ACTION_NAMESPACE = \"action\";\r\n\r\n/**\r\n * Describes a JSX Actions signature in full, including parameters\r\n * READONLY\r\n */\r\nexport class ActionDescriptor\r\n{\r\n    constructor()\r\n    {\r\n        this.name = \"\";\r\n        this.description = \"\";\r\n        this.path = \"\";\r\n        this.params = [];\r\n    }\r\n    /**\r\n     * Translate JSDocDescription object to ActionDescriptor\r\n     * @param {JSDocDescription} jsDocDescription the \"function\" description returned by JSDoc\r\n     */\r\n    static fromJSDoc(jsdocDescription)\r\n    {\r\n        /*\r\n            Example JSDoc Output:\r\n            {\r\n                \"name\": \"action.makeNote\",\r\n                \"description\": \"Add a Note/Annotation to the document\",\r\n                \"path\": \"C:\\\\Users\\\\puglisij\\\\AppData\\\\Roaming\\\\Adobe\\\\CEP\\\\extensions\\\\com.mario.panel\\\\public\\\\actions\",\r\n                \"params\": [\r\n                    {\r\n                    \"type\": { \"names\": [\"Number\"] },\r\n                    \"description\": \"x axis position in pixels\",\r\n                    \"name\": \"posX\"\r\n                    },\r\n                    {\r\n                    \"type\": { \"names\": [\"Number\"] },\r\n                    \"description\": \"y axis position in pixels\",\r\n                    \"name\": \"posY\"\r\n                    }\r\n                ]\r\n            }\r\n        */\r\n        \r\n        const d = jsdocDescription;\r\n        const descriptor = new ActionDescriptor();\r\n              descriptor.name = d.longname;\r\n              descriptor.description = d.description;\r\n              descriptor.params = d.params ? d.params.map(p => ActionParameter.fromJSDoc(p)) : [];\r\n              descriptor.path = d.meta.path;\r\n        return descriptor;\r\n    }\r\n}\r\n/**\r\n * Describes an (Input) parameter to a JSX Action function\r\n * READONLY\r\n */\r\nexport class ActionParameter \r\n{\r\n    constructor() \r\n    {\r\n        this.name = \"\";\r\n        this.description = \"\";\r\n        this.typeNames = [];\r\n        this.isRequired = false;\r\n        this.defaultValue = null;\r\n    }\r\n\r\n    static fromJSDoc(jsdocParameter) {\r\n        const { name, description, defaultValue, optional, type } = jsdocParameter;\r\n        const param = new ActionParameter();\r\n            param.name = name;\r\n            param.description = description;\r\n            param.defaultValue = defaultValue || null;\r\n            param.isRequired = !(optional === true);\r\n            param.typeNames = type.names.slice(0);\r\n\r\n        return param;\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n */\r\nclass ActionParameterCurator\r\n{\r\n    constructor(hostInterface)\r\n    {\r\n        this.host = hostInterface;\r\n        this.typeNameToDataCache = {};\r\n    }\r\n    /**\r\n     * Convert jsdoc parameter type name to Vue control component type\r\n     * @param {string} typeName any type for which a control exists (e.g. string, boolean, etc)\r\n     * @returns {string} \r\n     */\r\n    typeNameToControlInputType(typeName)\r\n    {\r\n        // call jsx functions to get type information\r\n        // this.host.runJsx('...');\r\n    }\r\n}\r\n\r\n/**\r\n * Handles reading JSX action files and JSDoc descriptions they contain\r\n */\r\nclass ActionFileDescriptionReader \r\n{\r\n    static _actionNameToJsDoc = new Map();\r\n    /**\r\n     * Reads and caches the JsDocDescription's for all the given actions\r\n     * @param {Action[]} actions \r\n     */\r\n    static async readAll(actions) \r\n    {\r\n        return jsdoc.explain({\r\n            cache: true,\r\n            files: actions.map(a => a.absolutePath)\r\n        })\r\n        .then(descriptions => \r\n        {\r\n            for(let i = 0; i < descriptions.length; ++i) \r\n            {\r\n                const description = descriptions[i];\r\n                if(this._isFunction(description)) {\r\n                    this._actionNameToJsDoc.set(description.longname, description);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Caches and returns the JsDocDescription for the given action\r\n     * @param {Action} action\r\n     * @returns {JSDocDescription}\r\n     */\r\n    static read(action)\r\n    {\r\n        let description = this._actionNameToJsDoc.get(action.name);\r\n        if(!description) {\r\n            console.warn(`JSDoc description not found for action ${action.name}. Do you need to re-load actions?`);\r\n            return {};\r\n        }\r\n        return description;\r\n    }\r\n    // FUNCTIONS:\r\n    // scope: \"static\"\r\n    // kind: \"function\"\r\n    // memberof: \"action\"\r\n    static _isFunction(jsdocDescription) \r\n    {\r\n        return jsdocDescription.scope === \"static\"\r\n            && jsdocDescription.kind === \"function\"\r\n            && jsdocDescription.memberof.startsWith(\"action\");\r\n    }\r\n    // ENUMERATIONS:\r\n    // name starts with capital letter\r\n    // scope: \"global\"\r\n    // kind: \"member\"\r\n    // memberof: undefined\r\n    // isEnum: true (only if @enum is in comment)\r\n    static _isEnum(jsdocDescription) \r\n    {\r\n        return jsdocDescription.scope === \"global\"\r\n            && jsdocDescription.kind === \"member\"\r\n            && jsdocDescription.isEnum === true\r\n            && typeof jsdocDescription.memberof === undefined;\r\n    }\r\n}\r\n\r\n/**\r\n * Handles reading JSX action files for import into Adobe host\r\n */\r\nclass ActionFileImportStringBuilder\r\n{\r\n    /**\r\n     * Reads all jsx files in the given directory and builds an import JSX string for execution.\r\n     * Each new directory encountered becomes a nested namespace.\r\n     * @param {string} pathToActions the directory containing the jsx files\r\n     * @param {string} rootNamespace the root action function namespace. All action names with start with this\r\n     * @returns {string} the stringified JSX script to run which will import all actions\r\n     */\r\n    static build(pathToActions, rootNamespace)\r\n    {\r\n        return this._buildJsxImportString(pathToActions, rootNamespace); \r\n    }\r\n    // NOTE: importAction() is expected to be defined on Host JSX side\r\n    static _buildJsxImportString(absolutePathToActions, rootNamespace)\r\n    {\r\n        let actions = [];\r\n        let imports = [];\r\n        let directory;\r\n        let directories = [\r\n            {\r\n                namespace: rootNamespace,\r\n                absolutePath: absolutePathToActions\r\n            }\r\n        ];\r\n        while(directory = directories.pop()) \r\n        {\r\n            const namespace = directory.namespace;\r\n            const namespaceDefine = `${namespace}= (typeof ${namespace} !== \"undefined\") ? ${namespace} : {};`;\r\n            imports.push(namespaceDefine);\r\n            \r\n            // Read directory contents\r\n            const names = fs.readdirSync(directory.absolutePath);\r\n            for(let i = 0; i < names.length; ++i) \r\n            {\r\n                const nameParts = names[i].split('.');\r\n                if(nameParts.length > 2) {\r\n                    throw new Error(\"Action file and directory names cannot contain periods.\");\r\n                }\r\n\r\n                const nameWithoutExtension = nameParts[0];\r\n                const nameSpacedName = `${namespace}.${nameWithoutExtension}`;\r\n                const absoluteFilePath = upath.join(directory.absolutePath, names[i]);\r\n                if(fs.statSync(absoluteFilePath).isDirectory()) \r\n                {\r\n                    directories.push({\r\n                        namespace: nameSpacedName,\r\n                        absolutePath: absoluteFilePath\r\n                    });\r\n                } \r\n                else \r\n                {\r\n                    imports.push(`importAction(\"${absoluteFilePath}\", \"${nameSpacedName}\");`);\r\n                    actions.push(new Action(nameSpacedName, namespace, absoluteFilePath));\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            importString: imports.join(''),\r\n            actions\r\n        };\r\n    }\r\n}\r\n\r\nclass Action\r\n{\r\n    constructor(name, namespace, absolutePath)\r\n    {\r\n        this.name = name;\r\n        this.namespace = namespace;\r\n        this.absolutePath = absolutePath;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Primary interface for loading/reloading jsx action files and their JSDoc descriptions\r\n */\r\nexport class Actions\r\n{\r\n    constructor() \r\n    {\r\n        this._actionNameToAction = new Map();\r\n        this._actionTree = new FolderTreeNode(ROOT_ACTION_NAMESPACE, true);\r\n    }\r\n    /**\r\n     * @returns {Promise}\r\n     */\r\n    init() \r\n    {\r\n        return this._importAll();\r\n    }\r\n    destroy() {}\r\n\r\n    /**\r\n     * Import all JSX function action files\r\n     */\r\n    async _importAll()\r\n    {\r\n        const pathToUserActions = store.general.pathToUserActions;\r\n        const pathToBuildInActions = global.appBuiltinActionsPath;\r\n        console.log(\"Import actions started.\");\r\n        console.log(`Importing from:\\n\\t${pathToUserActions}\\n\\t${pathToBuildInActions}`);\r\n        \r\n        await this._import(pathToBuildInActions);\r\n        if(pathToUserActions) \r\n        {\r\n            await this._import(pathToUserActions);\r\n            await host.runJsx(`action.CUSTOM_ACTIONS_FOLDER = new Folder(\"${pathToUserActions}\");`);\r\n        }\r\n\r\n        console.log(\"Import actions exited.\");\r\n    }\r\n    _import(importDirectory) \r\n    {\r\n        if(!importDirectory.trim()) {\r\n            return;\r\n        }\r\n\r\n        const { importString,  actions } = ActionFileImportStringBuilder.build(importDirectory, ROOT_ACTION_NAMESPACE);\r\n        // Parse to data structures\r\n        for(let i = 0; i < actions.length; ++i) \r\n        {\r\n            const actionPath = actions[i].name.split('.');\r\n            this._actionNameToAction.set(actions[i].name, actions[i]);\r\n            this._actionTree.insert(actionPath, false);\r\n            console.log(\"Action: \" + actions[i].name);\r\n        }\r\n        // Async read and cache jsdoc info\r\n        ActionFileDescriptionReader.readAll(actions);\r\n\r\n        return host.runJsx(importString  + \"act = action;\");\r\n    }\r\n    /**\r\n     * Returns tree structure of all available action nested namespaces/action names\r\n     * @returns {FolderTreeNode} n-ary tree indicating folder and action file structure\r\n     */\r\n    getAllActions() {\r\n        return this._actionTree.cloneTree(); \r\n    }\r\n    /**\r\n     * Return all available action names\r\n     * @returns {string[]}\r\n     */\r\n    getAllActionNames() {\r\n        return Array.from( this._actionNameToAction.keys() );\r\n    }\r\n    /**\r\n     * Converts JSDoc for given action name to instance of ActionDescriptor\r\n     * @param {string} actionName\r\n     * @returns {Promise<ActionDescriptor>}  \r\n     */\r\n    async getActionDescriptorByName(actionName) \r\n    {\r\n        const action = this._actionNameToAction.get(actionName);\r\n        if(!action) {\r\n            throw new Error(`Action doesnt exist by name ${actionName}`);\r\n        }\r\n\r\n        return new Promise(resolve => {\r\n            const d = ActionFileDescriptionReader.read(action)\r\n            const descriptor = ActionDescriptor.fromJSDoc(d);\r\n            resolve(descriptor);\r\n        });\r\n    }\r\n}\r\n","\r\n/* npm modules */\r\nimport EventEmitter from \"events\";\r\nimport polka from \"polka\";\r\n\r\n/* local modules */\r\nimport { PipelineEngine } from './pipelineEngine';\r\nimport { Actions } from './actions';\r\nimport _ from '../utils';\r\nimport store from '../store';\r\nimport global from '../global';\r\n\r\nlet port = 0;\r\nlet app = null;\r\n\r\n\r\nexport const ServerState = {\r\n    UNINITIALIZED: 0,\r\n    RUNNING: 1\r\n};\r\n\r\n/**\r\n * Backend systems.\r\n * Manages Node REST API, and JS API for managing pipelines. \r\n * Server is not CEP panel aware\r\n */\r\nclass Server extends EventEmitter\r\n{\r\n    constructor() \r\n    {\r\n        super();\r\n        this._initialized = false;\r\n        this._state = ServerState.UNINITIALIZED;\r\n\r\n        // Express instance\r\n        this._httpServer = null;\r\n        this._pipelineEngine = new PipelineEngine();\r\n        this._actions = new Actions();\r\n    }\r\n    /**\r\n     * @returns {Promise}\r\n     */\r\n    async init() \r\n    {\r\n        if(this._initialized) return;\r\n        this._initialized = true;\r\n\r\n        await this._pipelineEngine.init();\r\n        await this._actions.init();\r\n\r\n        if(store.general.runHttpServer) {\r\n            this.startServer();\r\n        }\r\n        this.state = ServerState.RUNNING;\r\n        this.emit(\"initialized\");\r\n        console.log(\"Server initialized.\");\r\n    }\r\n    async startServer() \r\n    {\r\n        port = store.general.serverPort;\r\n        app = polka();\r\n        //-----------------\r\n        // Routes\r\n        //-----------------\r\n        // app.get('/pipeline/:name/configuration', (req, res) => {\r\n        //     res.setHeader(\"Content-Type\", \"application/json\");\r\n        //     res.end(\r\n        //         JSON.stringify(this._pipelineConfig.pipelines.find(p => p.name == req.params.name.toLowerCase()), null, 4)\r\n        //     );\r\n        // });\r\n        // app.post('/pipeline/run', (req, res) => {\r\n        //     res.status(200).json({ success: true });\r\n        // });\r\n        // app.post('/pipeline/stop', (req, res) => {\r\n        //     res.status(200).json({ success: true });\r\n        // });\r\n        app.get('/status', (req, res) => {\r\n            const status = {\r\n                adobeApp: global.adobeApp,\r\n                adobeVersion: global.adobeVersion,\r\n                version: global.appVersion,\r\n                time: new Date().toLocaleString(),\r\n                ...this._pipelineEngine.fullStatus\r\n            };\r\n\r\n            res.writeHead(200, {\r\n                \"Content-Type\": \"application/json\"\r\n            });\r\n            res.end(JSON.stringify(status, null, 2) + '\\n');\r\n        });\r\n\r\n        //-----------------\r\n        // Create Server\r\n        //-----------------\r\n        this._httpServer = app.listen(port, \"0.0.0.0\", function() {\r\n            console.log(`Polka is listening to http://localhost:${port}`);\r\n        }).server;\r\n\r\n        // Native\r\n        // this._httpServer = http.createServer((req, res) => \r\n        // {\r\n        //      handle routing on req.url\r\n        // });\r\n        // this._httpServer.listen(port, \"0.0.0.0\", () => {\r\n        //     console.log(`Server is listening to http://localhost:${port}`);\r\n        // });\r\n\r\n        console.log(\"Server started.\");\r\n    }\r\n    destroy() \r\n    {\r\n        console.log(`Server closing...`);\r\n        this._httpServer && this._httpServer.close(() => {\r\n            this._httpServer = null;\r\n            console.log(`Server closed.`);\r\n        });\r\n        this._pipelineEngine.destroy();\r\n        this._pipelineEngine = null;\r\n        this._actions.destroy();\r\n        this._actions = null;\r\n    }\r\n    get pipelineEngine() {\r\n        return this._pipelineEngine;\r\n    }\r\n    get actions() {\r\n        return this._actions;\r\n    }\r\n    get state() {\r\n        return this._state;\r\n    }\r\n    set state(value) {\r\n        this._state = value;\r\n        this.emit(\"state\", value);\r\n    }\r\n}\r\n// DELETE. Note, to access in iframe use iframe.contentWindow.server\r\n// TODO: For DEBUG Only. When finished, remove \"window.server = \" from export.\r\nexport default (window.server = new Server());","\r\n\r\nexport default class CircleBuffer\r\n{\r\n    constructor(size)\r\n    {\r\n        if(size <= 0) {\r\n            throw new Error(\"Size must be greater than 0.\");\r\n        }\r\n        this._array = new Array(size);\r\n        this._size = size;\r\n        this._pointer = 0;\r\n    }\r\n\r\n    push(val)\r\n    {\r\n        this._array[this._pointer] = val;\r\n        this._pointer = (this._pointer + 1) % this._size;\r\n    }\r\n    clear() {\r\n        this._array = new Array(this._size);\r\n        this._pointer = 0;\r\n    }\r\n    /**\r\n     * Returns underlying array by reference. This is NOT a clone.\r\n     */\r\n    toArray()\r\n    {\r\n        return this._array;\r\n    }\r\n}","import upath from \"upath\";\r\nimport fs from \"fs\";\r\nimport { EventEmitter } from \"events\";\r\nimport global from '../global';\r\nimport store from '../store';\r\nimport fsx from '../fsx';\r\nimport CircleBuffer from '@/circleBuffer';\r\n\r\nconst CONSOLE_METHODS = [\"log\", \"warn\", \"error\"];\r\n\r\nclass Logger extends EventEmitter\r\n{\r\n    constructor()\r\n    {\r\n        super();\r\n        this.initialized = false;\r\n        this.options = {\r\n            logDirectory: \"\",\r\n            logFilePersistForDays: 7 // number of files/days to keep\r\n        };\r\n        this.originalConsoleMethods = {};\r\n        this.logWriteStream = null;\r\n        this.currentLogFileMonthDay = 0;\r\n        this.htmlLogBuffer = null;\r\n    }\r\n    /**\r\n     * @returns {Promise}\r\n     */\r\n    async init() \r\n    {\r\n        if(this.initialized)\r\n            return;\r\n\r\n        this.initialized = true;\r\n        this.options = {\r\n            logDirectory: store.general.logDirectory || global.appDefaultLogPath, \r\n            logFilePersistForDays: store.general.logFilePersistForDays > 0 ? store.general.logFilePersistForDays : 3,\r\n            logHtmlBufferMaxSize: store.general.logHtmlBufferMaxSize > 0 ? store.general.logHtmlBufferMaxSize : 256\r\n        };\r\n        this.htmlLogBuffer = new CircleBuffer(this.options.logHtmlBufferMaxSize);\r\n\r\n        // Proxy default console logging methods\r\n        CONSOLE_METHODS.forEach(function(method)\r\n        {\r\n            const self = this;\r\n            const originalMethod = console[method].bind(console);\r\n            this.originalConsoleMethods[method] = originalMethod;\r\n\r\n            console[method] = function() {\r\n                const args = Array.prototype.slice.call(arguments);\r\n                originalMethod.apply(\r\n                    console,\r\n                    args\r\n                );\r\n                self._write(method, args);\r\n            };\r\n        }.bind(this));\r\n\r\n        await this._createLogsDirectory();\r\n        this._cleanupOldFiles();\r\n        this._createFileStream();\r\n\r\n        this.emit(\"initialized\");\r\n        console.log(`Logger initialized.\\n\\t${this.options.logDirectory}`);\r\n    }\r\n    _write(method, args)\r\n    {\r\n        const date = new Date();\r\n        const chunk = [date.toLocaleTimeString(), `[${method.toUpperCase()}]\\t`, ...args, `\\n`].join(\" \");\r\n        const htmlChunk = [`<div class=\"${method}\">${date.toLocaleTimeString()}`, ...args, `</div>`].join(\" \");\r\n        \r\n        if(date.getDate() !== this.currentLogFileMonthDay) {\r\n            this._createFileStream();\r\n        }\r\n        this.logWriteStream && this.logWriteStream.write(chunk);\r\n        this.htmlLogBuffer.push(htmlChunk);\r\n        this.emit(\"logs\");\r\n    }\r\n    _createLogsDirectory() \r\n    {\r\n        return new Promise((resolve, reject) => {\r\n            fsx.mkdir(this.options.logDirectory, { recursive: true }, err => {\r\n                if(err && err.code !== \"ENOENT\") reject(`${err}\\nCould not create directory.`);\r\n                else resolve();\r\n            });\r\n        });\r\n    }\r\n    _createFileStream()\r\n    {\r\n        this._closeFileStream();\r\n\r\n        const date = new Date();\r\n        const logPath = upath.join(this.options.logDirectory, date.toISOString().slice(0,10) + \".logs\");\r\n        this.currentLogFileMonthDay = date.getDate(); \r\n        this.logWriteStream = fs.createWriteStream(logPath, {\r\n            flags: \"a\",\r\n            encoding: \"utf8\",\r\n            autoClose: true // close on error or end\r\n        });\r\n        this.logWriteStream.on(\"error\", error => {\r\n            this._closeFileStream();\r\n            // TODO: Attempt to create stream again?\r\n            console.log(`Log file stream error.\\n${error}`)\r\n        });\r\n        this.logWriteStream.on(\"close\", event => {\r\n            this._closeFileStream();\r\n            console.log(`Log file stream closed.`);\r\n        });\r\n    }\r\n    _closeFileStream()\r\n    {\r\n        if(this.logWriteStream) {\r\n            this.logWriteStream.removeAllListeners();\r\n            this.logWriteStream.end();\r\n            this.logWriteStream = null;\r\n        }\r\n    }\r\n    _cleanupOldFiles()\r\n    {\r\n        fs.readdir(this.options.logDirectory, (err, paths) => \r\n        {\r\n            if(err) {\r\n                return;\r\n            }\r\n            const logFilenames = paths.filter(name => name.endsWith(\".logs\"));\r\n                  logFilenames.sort(); // sort by date\r\n                  logFilenames.pop(); // don't delete todays\r\n            const logPaths = logFilenames.map(name => upath.join(this.options.logDirectory, name));\r\n            const howManyToDelete = Math.max(logPaths.length - this.options.logFilePersistForDays, 0);\r\n\r\n            for(let i = 0; i < howManyToDelete; ++i) \r\n            {\r\n                fs.unlink(logPaths[i], err => {\r\n                    if(err) console.error(\"Could not delete log file. \", err);\r\n                });\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Clear all the buffered html logs\r\n     */\r\n    clear() \r\n    {\r\n        this.htmlLogBuffer.clear();\r\n    }\r\n    /**\r\n     * Read all buffered logs formatted with html\r\n     * @returns {string}\r\n     */\r\n    read()\r\n    {\r\n        return this.htmlLogBuffer.toArray().reduce((acc, val) => `${acc}${val}`, ``);\r\n    }\r\n    /**\r\n     * Should be called to release internal resources\r\n     */\r\n    destroy() \r\n    {\r\n        console.log(\"Logger destroyed.\");\r\n\r\n        if(!this.initialized) \r\n            return;\r\n        this.initialized = false;\r\n\r\n        this._closeFileStream();\r\n\r\n        // Restore console methods\r\n        CONSOLE_METHODS.forEach(method => {\r\n            console[method] = this.originalConsoleMethods[method];\r\n        });\r\n\r\n        logger = null;\r\n    }\r\n}\r\n\r\nlet logger = new Logger();\r\nexport default logger;","module.exports = require(\"process\");","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./a-dialog-root.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./a-dialog-root.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tabs.vue?vue&type=style&index=0&id=55ac743d&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tabs.vue?vue&type=style&index=0&id=55ac743d&lang=scss&scoped=true&\"","module.exports = require(\"querystring\");","import child_process from 'child_process';\r\nimport upath from 'upath';\r\nimport fs from 'fs';\r\nimport rimraf from 'rimraf';\r\n\r\n/**\r\n * Force deletes the destination file/directory recursively and renames the source path to the destination\r\n * @param {*} fromPath \r\n * @param {*} toPath \r\n * @param {*} callback \r\n */\r\nfunction overwrite(fromPath, toPath, callback)\r\n{\r\n    rimraf(toPath, err => \r\n    {\r\n        if(err) {\r\n            callback(err);\r\n            return;\r\n        }\r\n        fs.rename(fromPath, toPath, err => {\r\n            callback(err);\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * UNTESTED. Same as fs.rmdir except delegates to rimraf() when using recursive option\r\n * @param {*} path \r\n * @param {*} options \r\n * @param {*} cb \r\n */\r\nfunction rmdir(path, options, cb) \r\n{\r\n    if(typeof options === 'object' && options.recursive) {\r\n        rimraf(path, {\r\n            maxBusyTries: options.maxRetries,\r\n            emfileWait: retryDelay\r\n        }, cb);\r\n    } else {\r\n        fs.rmdir.call(fs, arguments);\r\n    }\r\n}\r\n\r\n/**\r\n * Same as fs.mkdir except supports options object and recursive option\r\n * This exists because { recursive: true } option not supported prior to Node v10.22\r\n * NOTE: When using 'recursive' option, call is delegated to shell command 'mkdir' and\r\n * any errors returned as a string\r\n * @param {string|Buffer|URL} dirPath \r\n * @param {object} options \r\n * @param {number} options.mode \r\n * @param {boolean} options.recursive \r\n * @param {function} callback \r\n */\r\nfunction mkdir(dirPath, options, callback) \r\n{\r\n    if(typeof options === 'object' && options.recursive) {\r\n        _mkdirRecursive(dirPath, options, callback);\r\n    } else {\r\n        fs.mkdir.call(fs, arguments);\r\n    }\r\n}\r\nfunction _mkdirRecursive(dirPath, options, callback) \r\n{\r\n    child_process.exec(\r\n        `mkdir${options.mode ? ' --parents --mode=' + options.mode : ''} \"${dirPath}\"`, \r\n        (error, stdout, stderr) => {\r\n            if(error) {\r\n                // IMPORTANT: For some reason, on windows, when creating a directory \r\n                // on a mapped network drive, this command will both create the directory\r\n                // AND throw an \"already exists\" error\r\n                if(error.toString().toLowerCase().includes(\"already exists\")) {\r\n                    error.code = \"ENOENT\";\r\n                }\r\n                callback(error);\r\n            } else {\r\n                callback();\r\n            }\r\n        }\r\n    );\r\n} \r\n\r\n\r\nexport default {\r\n    rmdir,\r\n    mkdir,\r\n    overwrite\r\n}","module.exports = require(\"events\");"],"sourceRoot":""}